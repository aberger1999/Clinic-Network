<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin Panel - CS631 Project</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body>
    <nav class="navbar navbar-expand-lg navbar-dark bg-dark">
        <div class="container">
            <a class="navbar-brand" href="/">CS631 Project</a>
            <div class="collapse navbar-collapse">
                <ul class="navbar-nav ms-auto">
                    <li class="nav-item">
                        <a class="nav-link active" href="/admin">Admin Panel</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="/application">Application</a>
                    </li>
                </ul>
            </div>
        </div>
    </nav>
    <div class="container mt-4">
        <h2>Admin Panel</h2>
        <div class="mb-3">
            <label for="tableSelector" class="form-label">Select Table:</label>
            <select class="form-select" id="tableSelector">
                <option value="corporations">Corporation</option>
                <option value="clinics">Clinic</option>
                <option value="employees">Employee</option>
                <option value="physicians">Physician</option>
                <option value="nurses">Nurse</option>
                <option value="surgeons">Surgeon</option>
                <option value="shifts">Shift</option>
                <option value="patients">Patient</option>
                <option value="medicaldata">MedicalData</option>
                <option value="allergies">Allergy</option>
                <option value="illnesses">Illness</option>
                <option value="clinicbeds">Clinic Bed</option>
                <option value="admittedto">AdmittedTo</option>
                <option value="attendsto">AttendsTo</option>
                <option value="diagnoses">Diagnosis</option>
                <option value="patientallergies">Patient_Allergy</option>
                <option value="reactswith">ReactsWith</option>
                <option value="prescriptions">Prescription</option>
                <option value="surgerytypes">Surgery_Type</option>
                <option value="surgeryskills">Surgery_Skill</option>
                <option value="surgerytypeskills">Surgery_Type_Skill</option>
                <option value="nurseskills">Nurse_Skill</option>
                <option value="nursesurgerytypes">Nurse_Surgery_Type</option>
                <option value="surgeryschedules">Surgery_Schedule</option>
                <option value="surgeries">Surgery</option>
            </select>
        </div>
        <div id="tableContent">
            <!-- Table data and forms will be loaded here dynamically -->
        </div>
    </div>
    <!-- Edit Physician Modal -->
    <div class="modal fade" id="editPhysicianModal" tabindex="-1" aria-labelledby="editPhysicianModalLabel" aria-hidden="true">
      <div class="modal-dialog">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title" id="editPhysicianModalLabel">Edit Physician</h5>
            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
          </div>
          <div class="modal-body">
            <form id="editPhysicianForm">
              <input type="hidden" id="editPhysicianId">
              <div class="mb-3">
                <label for="editPhysicianSpecialty" class="form-label">Specialty</label>
                <input type="text" class="form-control" id="editPhysicianSpecialty" required>
              </div>
              <div class="mb-3">
                <label for="editPhysicianType" class="form-label">Type</label>
                <input type="text" class="form-control" id="editPhysicianType" required>
              </div>
              <button type="submit" class="btn btn-primary w-100">Save</button>
            </form>
          </div>
        </div>
      </div>
    </div>
    <!-- Edit Nurse Modal -->
    <div class="modal fade" id="editNurseModal" tabindex="-1" aria-labelledby="editNurseModalLabel" aria-hidden="true">
      <div class="modal-dialog">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title" id="editNurseModalLabel">Edit Nurse</h5>
            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
          </div>
          <div class="modal-body">
            <form id="editNurseForm">
              <input type="hidden" id="editNurseId">
              <div class="mb-3">
                <label for="editNurseGrade" class="form-label">Grade</label>
                <input type="text" class="form-control" id="editNurseGrade" required>
              </div>
              <div class="mb-3">
                <label for="editNurseYears" class="form-label">Years</label>
                <input type="number" class="form-control" id="editNurseYears" required>
              </div>
              <button type="submit" class="btn btn-primary w-100">Save</button>
            </form>
          </div>
        </div>
      </div>
    </div>
    <!-- Edit Surgeon Modal -->
    <div class="modal fade" id="editSurgeonModal" tabindex="-1" aria-labelledby="editSurgeonModalLabel" aria-hidden="true">
      <div class="modal-dialog">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title" id="editSurgeonModalLabel">Edit Surgeon</h5>
            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
          </div>
          <div class="modal-body">
            <form id="editSurgeonForm">
              <input type="hidden" id="editSurgeonId">
              <div class="mb-3">
                <label for="editSurgeonSpecialty" class="form-label">Specialty</label>
                <input type="text" class="form-control" id="editSurgeonSpecialty" required>
              </div>
              <div class="mb-3">
                <label for="editSurgeonContractType" class="form-label">Contract Type</label>
                <input type="text" class="form-control" id="editSurgeonContractType" required>
              </div>
              <div class="mb-3">
                <label for="editSurgeonContractDuration" class="form-label">Contract Duration</label>
                <input type="number" class="form-control" id="editSurgeonContractDuration" required>
              </div>
              <div class="mb-3">
                <label for="editSurgeonContractAmount" class="form-label">Contract Amount</label>
                <input type="number" step="0.01" class="form-control" id="editSurgeonContractAmount">
              </div>
              <button type="submit" class="btn btn-primary w-100">Save</button>
            </form>
          </div>
        </div>
      </div>
    </div>
    <!-- Edit Patient_Allergy Modal -->
    <div class="modal fade" id="editPatientAllergyModal" tabindex="-1" aria-labelledby="editPatientAllergyModalLabel" aria-hidden="true">
      <div class="modal-dialog">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title" id="editPatientAllergyModalLabel">Edit Patient_Allergy</h5>
            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
          </div>
          <div class="modal-body">
            <form id="editPatientAllergyForm">
              <input type="hidden" id="editPatientAllergyPID">
              <input type="hidden" id="editPatientAllergyOldAllergyCode">
              <div class="mb-3">
                <label for="editPatientAllergyAllergyCode" class="form-label">AllergyCode</label>
                <input type="number" class="form-control" id="editPatientAllergyAllergyCode" required>
              </div>
              <button type="submit" class="btn btn-primary w-100">Save</button>
            </form>
          </div>
        </div>
      </div>
    </div>
    <!-- Edit Surgery_Type Modal -->
    <div class="modal fade" id="editSurgeryTypeModal" tabindex="-1" aria-labelledby="editSurgeryTypeModalLabel" aria-hidden="true">
      <div class="modal-dialog">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title" id="editSurgeryTypeModalLabel">Edit Surgery_Type</h5>
            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
          </div>
          <div class="modal-body">
            <form id="editSurgeryTypeForm">
              <div class="mb-3">
                <label for="editSurgeryTypeCode" class="form-label">SurgeryCode</label>
                <input type="number" class="form-control" id="editSurgeryTypeCode" readonly>
              </div>
              <div class="mb-3">
                <label for="editSurgeryTypeName" class="form-label">Name</label>
                <input type="text" class="form-control" id="editSurgeryTypeName" required>
              </div>
              <div class="mb-3">
                <label for="editSurgeryTypeType" class="form-label">Type (H/O)</label>
                <input type="text" class="form-control" id="editSurgeryTypeType" required>
              </div>
              <div class="mb-3">
                <label for="editSurgeryTypeAnatomicLocation" class="form-label">AnatomicLocation</label>
                <input type="text" class="form-control" id="editSurgeryTypeAnatomicLocation" required>
              </div>
              <div class="mb-3">
                <label for="editSurgeryTypeSpecialNeeds" class="form-label">SpecialNeeds</label>
                <input type="text" class="form-control" id="editSurgeryTypeSpecialNeeds">
              </div>
              <button type="submit" class="btn btn-primary w-100">Save</button>
            </form>
          </div>
        </div>
      </div>
    </div>
    <!-- Edit Surgery_Skill Modal -->
    <div class="modal fade" id="editSurgerySkillModal" tabindex="-1" aria-labelledby="editSurgerySkillModalLabel" aria-hidden="true">
      <div class="modal-dialog">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title" id="editSurgerySkillModalLabel">Edit Surgery_Skill</h5>
            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
          </div>
          <div class="modal-body">
            <form id="editSurgerySkillForm">
              <div class="mb-3">
                <label for="editSurgerySkillCode" class="form-label">SkillCode</label>
                <input type="number" class="form-control" id="editSurgerySkillCode" readonly>
              </div>
              <div class="mb-3">
                <label for="editSurgerySkillDescription" class="form-label">Description</label>
                <input type="text" class="form-control" id="editSurgerySkillDescription" required>
              </div>
              <button type="submit" class="btn btn-primary w-100">Save</button>
            </form>
          </div>
        </div>
      </div>
    </div>
    <!-- Edit Surgery_Type_Skill Modal -->
    <div class="modal fade" id="editSurgeryTypeSkillModal" tabindex="-1" aria-labelledby="editSurgeryTypeSkillModalLabel" aria-hidden="true">
      <div class="modal-dialog">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title" id="editSurgeryTypeSkillModalLabel">Edit Surgery_Type_Skill</h5>
            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
          </div>
          <div class="modal-body">
            <form id="editSurgeryTypeSkillForm">
              <input type="hidden" id="editSurgeryTypeSkillOldSurgeryCode">
              <input type="hidden" id="editSurgeryTypeSkillOldSkillCode">
              <div class="mb-3">
                <label for="editSurgeryTypeSkillSurgeryCode" class="form-label">SurgeryCode</label>
                <input type="number" class="form-control" id="editSurgeryTypeSkillSurgeryCode" required>
              </div>
              <div class="mb-3">
                <label for="editSurgeryTypeSkillSkillCode" class="form-label">SkillCode</label>
                <input type="number" class="form-control" id="editSurgeryTypeSkillSkillCode" required>
              </div>
              <button type="submit" class="btn btn-primary w-100">Save</button>
            </form>
          </div>
        </div>
      </div>
    </div>
    <!-- Edit Nurse_Skill Modal -->
    <div class="modal fade" id="editNurseSkillModal" tabindex="-1" aria-labelledby="editNurseSkillModalLabel" aria-hidden="true">
      <div class="modal-dialog">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title" id="editNurseSkillModalLabel">Edit Nurse_Skill</h5>
            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
          </div>
          <div class="modal-body">
            <form id="editNurseSkillForm">
              <input type="hidden" id="editNurseSkillOldNurseID">
              <input type="hidden" id="editNurseSkillOldSkillCode">
              <div class="mb-3">
                <label for="editNurseSkillNurseID" class="form-label">NurseID</label>
                <input type="number" class="form-control" id="editNurseSkillNurseID" required>
              </div>
              <div class="mb-3">
                <label for="editNurseSkillSkillCode" class="form-label">SkillCode</label>
                <input type="number" class="form-control" id="editNurseSkillSkillCode" required>
              </div>
              <button type="submit" class="btn btn-primary w-100">Save</button>
            </form>
          </div>
        </div>
      </div>
    </div>
    <!-- Edit Nurse_Surgery_Type Modal -->
    <div class="modal fade" id="editNurseSurgeryTypeModal" tabindex="-1" aria-labelledby="editNurseSurgeryTypeModalLabel" aria-hidden="true">
      <div class="modal-dialog">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title" id="editNurseSurgeryTypeModalLabel">Edit Nurse_Surgery_Type</h5>
            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
          </div>
          <div class="modal-body">
            <form id="editNurseSurgeryTypeForm">
              <input type="hidden" id="editNurseSurgeryTypeOldNurseID">
              <input type="hidden" id="editNurseSurgeryTypeOldSurgeryCode">
              <div class="mb-3">
                <label for="editNurseSurgeryTypeNurseID" class="form-label">NurseID</label>
                <input type="number" class="form-control" id="editNurseSurgeryTypeNurseID" required>
              </div>
              <div class="mb-3">
                <label for="editNurseSurgeryTypeSurgeryCode" class="form-label">SurgeryCode</label>
                <input type="number" class="form-control" id="editNurseSurgeryTypeSurgeryCode" required>
              </div>
              <button type="submit" class="btn btn-primary w-100">Save</button>
            </form>
          </div>
        </div>
      </div>
    </div>
    <!-- Edit Surgery_Schedule Modal -->
    <div class="modal fade" id="editSurgeryScheduleModal" tabindex="-1" aria-labelledby="editSurgeryScheduleModalLabel" aria-hidden="true">
      <div class="modal-dialog">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title" id="editSurgeryScheduleModalLabel">Edit Surgery_Schedule</h5>
            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
          </div>
          <div class="modal-body">
            <form id="editSurgeryScheduleForm">
              <input type="hidden" id="editSurgeryScheduleOldNurseID">
              <input type="hidden" id="editSurgeryScheduleOldSurgeryShift">
              <input type="hidden" id="editSurgeryScheduleOldDate">
              <div class="mb-3">
                <label for="editSurgeryScheduleNurseID" class="form-label">NurseID</label>
                <input type="number" class="form-control" id="editSurgeryScheduleNurseID" required>
              </div>
              <div class="mb-3">
                <label for="editSurgeryScheduleSurgeryShift" class="form-label">SurgeryShift</label>
                <input type="text" class="form-control" id="editSurgeryScheduleSurgeryShift" required>
              </div>
              <div class="mb-3">
                <label for="editSurgeryScheduleDate" class="form-label">Date</label>
                <input type="date" class="form-control" id="editSurgeryScheduleDate" required>
              </div>
              <button type="submit" class="btn btn-primary w-100">Save</button>
            </form>
          </div>
        </div>
      </div>
    </div>
    <!-- Edit Corporation Modal -->
    <div class="modal fade" id="editCorporationModal" tabindex="-1" aria-labelledby="editCorporationModalLabel" aria-hidden="true">
      <div class="modal-dialog">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title" id="editCorporationModalLabel">Edit Corporation</h5>
            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
          </div>
          <div class="modal-body">
            <form id="editCorporationForm">
              <input type="hidden" id="editCorporationName">
              <div class="mb-3">
                <label for="editCorporationPercentOwn" class="form-label">Percent Own</label>
                <input type="number" class="form-control" id="editCorporationPercentOwn" step="0.01" required>
              </div>
              <div class="mb-3">
                <label for="editCorporationStreet" class="form-label">Headquarters Street</label>
                <input type="text" class="form-control" id="editCorporationStreet" required>
              </div>
              <div class="mb-3">
                <label for="editCorporationCity" class="form-label">Headquarters City</label>
                <input type="text" class="form-control" id="editCorporationCity" required>
              </div>
              <div class="mb-3">
                <label for="editCorporationState" class="form-label">Headquarters State</label>
                <input type="text" class="form-control" id="editCorporationState" required>
              </div>
              <div class="mb-3">
                <label for="editCorporationZip" class="form-label">Headquarters Zip</label>
                <input type="text" class="form-control" id="editCorporationZip" required>
              </div>
              <button type="submit" class="btn btn-primary w-100">Save</button>
            </form>
          </div>
        </div>
      </div>
    </div>
    <!-- Edit Clinic Modal -->
    <div class="modal fade" id="editClinicModal" tabindex="-1" aria-labelledby="editClinicModalLabel" aria-hidden="true">
      <div class="modal-dialog">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title" id="editClinicModalLabel">Edit Clinic</h5>
            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
          </div>
          <div class="modal-body">
            <form id="editClinicForm">
              <input type="hidden" id="editClinicName">
              <div class="mb-3">
                <label for="editClinicStreet" class="form-label">Street</label>
                <input type="text" class="form-control" id="editClinicStreet" required>
              </div>
              <div class="mb-3">
                <label for="editClinicCity" class="form-label">City</label>
                <input type="text" class="form-control" id="editClinicCity" required>
              </div>
              <div class="mb-3">
                <label for="editClinicState" class="form-label">State</label>
                <input type="text" class="form-control" id="editClinicState" required>
              </div>
              <div class="mb-3">
                <label for="editClinicZip" class="form-label">Zip</label>
                <input type="text" class="form-control" id="editClinicZip" required>
              </div>
              <div class="mb-3">
                <label for="editClinicOwnerID" class="form-label">OwnerID</label>
                <input type="number" class="form-control" id="editClinicOwnerID">
              </div>
              <button type="submit" class="btn btn-primary w-100">Save</button>
            </form>
          </div>
        </div>
      </div>
    </div>
    <!-- Edit Employee Modal -->
    <div class="modal fade" id="editEmployeeModal" tabindex="-1" aria-labelledby="editEmployeeModalLabel" aria-hidden="true">
      <div class="modal-dialog">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title" id="editEmployeeModalLabel">Edit Employee</h5>
            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
          </div>
          <div class="modal-body">
            <form id="editEmployeeForm">
              <input type="hidden" id="editEmployeeId">
              <div class="mb-3">
                <label for="editEmployeeFirstName" class="form-label">First Name</label>
                <input type="text" class="form-control" id="editEmployeeFirstName" required>
              </div>
              <div class="mb-3">
                <label for="editEmployeeLastName" class="form-label">Last Name</label>
                <input type="text" class="form-control" id="editEmployeeLastName" required>
              </div>
              <div class="mb-3">
                <label for="editEmployeeSSN" class="form-label">SSN</label>
                <input type="text" class="form-control" id="editEmployeeSSN" required>
              </div>
              <div class="mb-3">
                <label for="editEmployeeSalary" class="form-label">Salary</label>
                <input type="number" class="form-control" id="editEmployeeSalary" step="0.01">
              </div>
              <div class="mb-3">
                <label for="editEmployeeGender" class="form-label">Gender</label>
                <select class="form-control" id="editEmployeeGender" required>
                  <option value="">Select Gender</option>
                  <option value="M">Male</option>
                  <option value="F">Female</option>
                </select>
              </div>
              <div class="mb-3">
                <label for="editEmployeeType" class="form-label">Type</label>
                <select class="form-control" id="editEmployeeType" required>
                  <option value="">Select Type</option>
                  <option value="Physician">Physician</option>
                  <option value="Nurse">Nurse</option>
                  <option value="Surgeon">Surgeon</option>
                  <option value="Support">Support</option>
                </select>
              </div>
              <div class="mb-3">
                <label for="editEmployeePhone" class="form-label">Phone</label>
                <input type="text" class="form-control" id="editEmployeePhone" required>
              </div>
              <div class="mb-3">
                <label for="editEmployeeStreet" class="form-label">Street</label>
                <input type="text" class="form-control" id="editEmployeeStreet" required>
              </div>
              <div class="mb-3">
                <label for="editEmployeeCity" class="form-label">City</label>
                <input type="text" class="form-control" id="editEmployeeCity" required>
              </div>
              <div class="mb-3">
                <label for="editEmployeeState" class="form-label">State</label>
                <input type="text" class="form-control" id="editEmployeeState" required>
              </div>
              <div class="mb-3">
                <label for="editEmployeeZip" class="form-label">Zip</label>
                <input type="text" class="form-control" id="editEmployeeZip" required>
              </div>
              <div id="editEmployeeTypeSpecificFields"></div>
              <button type="submit" class="btn btn-primary w-100">Save</button>
            </form>
          </div>
        </div>
      </div>
    </div>
    <!-- Edit Shift Modal -->
    <div class="modal fade" id="editShiftModal" tabindex="-1" aria-labelledby="editShiftModalLabel" aria-hidden="true">
      <div class="modal-dialog">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title" id="editShiftModalLabel">Edit Shift</h5>
            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
          </div>
          <div class="modal-body">
            <form id="editShiftForm">
              <input type="hidden" id="editShiftEmpID">
              <input type="hidden" id="editShiftDay">
              <div class="mb-3">
                <label for="editShiftBeginTime" class="form-label">Begin Time</label>
                <input type="time" class="form-control" id="editShiftBeginTime" required>
              </div>
              <div class="mb-3">
                <label for="editShiftEndTime" class="form-label">End Time</label>
                <input type="time" class="form-control" id="editShiftEndTime" required>
              </div>
              <button type="submit" class="btn btn-primary w-100">Save</button>
            </form>
          </div>
        </div>
      </div>
    </div>
    <!-- Edit Patient Modal -->
    <div class="modal fade" id="editPatientModal" tabindex="-1" aria-labelledby="editPatientModalLabel" aria-hidden="true">
      <div class="modal-dialog">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title" id="editPatientModalLabel">Edit Patient</h5>
            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
          </div>
          <div class="modal-body">
            <form id="editPatientForm">
              <input type="hidden" id="editPatientPID">
              <div class="mb-3">
                <label for="editPatientPrimaryPhysician" class="form-label">Primary Physician EmpID</label>
                <input type="number" class="form-control" id="editPatientPrimaryPhysician" required>
              </div>
              <div class="mb-3">
                <label for="editPatientDOB" class="form-label">Date of Birth</label>
                <input type="date" class="form-control" id="editPatientDOB" required>
              </div>
              <div class="mb-3">
                <label for="editPatientSSN" class="form-label">SSN</label>
                <input type="text" class="form-control" id="editPatientSSN" required>
              </div>
              <div class="mb-3">
                <label for="editPatientFirstName" class="form-label">First Name</label>
                <input type="text" class="form-control" id="editPatientFirstName" required>
              </div>
              <div class="mb-3">
                <label for="editPatientLastName" class="form-label">Last Name</label>
                <input type="text" class="form-control" id="editPatientLastName" required>
              </div>
              <div class="mb-3">
                <label for="editPatientGender" class="form-label">Gender</label>
                <select class="form-control" id="editPatientGender" required>
                  <option value="">Select Gender</option>
                  <option value="M">Male</option>
                  <option value="F">Female</option>
                </select>
              </div>
              <div class="mb-3">
                <label for="editPatientBloodType" class="form-label">Blood Type</label>
                <input type="text" class="form-control" id="editPatientBloodType" required>
              </div>
              <div class="mb-3">
                <label for="editPatientStreet" class="form-label">Street</label>
                <input type="text" class="form-control" id="editPatientStreet" required>
              </div>
              <div class="mb-3">
                <label for="editPatientCity" class="form-label">City</label>
                <input type="text" class="form-control" id="editPatientCity" required>
              </div>
              <div class="mb-3">
                <label for="editPatientState" class="form-label">State</label>
                <input type="text" class="form-control" id="editPatientState" required>
              </div>
              <div class="mb-3">
                <label for="editPatientZip" class="form-label">Zip</label>
                <input type="text" class="form-control" id="editPatientZip" required>
              </div>
              <button type="submit" class="btn btn-primary w-100">Save</button>
            </form>
          </div>
        </div>
      </div>
    </div>
    <!-- Edit Medical Data Modal -->
    <div class="modal fade" id="editMedicalDataModal" tabindex="-1" aria-labelledby="editMedicalDataModalLabel" aria-hidden="true">
      <div class="modal-dialog">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title" id="editMedicalDataModalLabel">Edit Medical Data</h5>
            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
          </div>
          <div class="modal-body">
            <form id="editMedicalDataForm">
              <input type="hidden" id="editMedicalDataPID">
              <div class="mb-3">
                <label for="editMedicalDataBloodSugar" class="form-label">Blood Sugar</label>
                <input type="number" class="form-control" id="editMedicalDataBloodSugar" step="0.01">
              </div>
              <div class="mb-3">
                <label for="editMedicalDataCholesterol" class="form-label">Cholesterol</label>
                <input type="number" class="form-control" id="editMedicalDataCholesterol" step="0.01">
              </div>
              <div class="mb-3">
                <label for="editMedicalDataTriglycerides" class="form-label">Triglycerides</label>
                <input type="number" class="form-control" id="editMedicalDataTriglycerides" step="0.01">
              </div>
              <div class="mb-3">
                <label for="editMedicalDataHDL" class="form-label">HDL</label>
                <input type="number" class="form-control" id="editMedicalDataHDL" step="0.01">
              </div>
              <div class="mb-3">
                <label for="editMedicalDataLDL" class="form-label">LDL</label>
                <input type="number" class="form-control" id="editMedicalDataLDL" step="0.01">
              </div>
              <div class="mb-3">
                <label for="editMedicalDataLastUpdate" class="form-label">Last Update</label>
                <input type="date" class="form-control" id="editMedicalDataLastUpdate" required>
              </div>
              <div class="mb-3">
                <label for="editMedicalDataHeartRisk" class="form-label">Heart Risk</label>
                <input type="text" class="form-control" id="editMedicalDataHeartRisk">
              </div>
              <button type="submit" class="btn btn-primary w-100">Save</button>
            </form>
          </div>
        </div>
      </div>
    </div>
    <!-- Edit Allergy Modal -->
    <div class="modal fade" id="editAllergyModal" tabindex="-1" aria-labelledby="editAllergyModalLabel" aria-hidden="true">
      <div class="modal-dialog">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title" id="editAllergyModalLabel">Edit Allergy</h5>
            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
          </div>
          <div class="modal-body">
            <form id="editAllergyForm">
              <input type="hidden" id="editAllergyCode">
              <div class="mb-3">
                <label for="editAllergyDescription" class="form-label">Description</label>
                <input type="text" class="form-control" id="editAllergyDescription" required>
              </div>
              <button type="submit" class="btn btn-primary w-100">Save</button>
            </form>
          </div>
        </div>
      </div>
    </div>
    <!-- Edit Illness Modal -->
    <div class="modal fade" id="editIllnessModal" tabindex="-1" aria-labelledby="editIllnessModalLabel" aria-hidden="true">
      <div class="modal-dialog">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title" id="editIllnessModalLabel">Edit Illness</h5>
            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
          </div>
          <div class="modal-body">
            <form id="editIllnessForm">
              <input type="hidden" id="editIllnessCode">
              <div class="mb-3">
                <label for="editIllnessDescription" class="form-label">Description</label>
                <input type="text" class="form-control" id="editIllnessDescription" required>
              </div>
              <button type="submit" class="btn btn-primary w-100">Save</button>
            </form>
          </div>
        </div>
      </div>
    </div>
    <!-- Edit Clinic Bed Modal -->
    <div class="modal fade" id="editClinicBedModal" tabindex="-1" aria-labelledby="editClinicBedModalLabel" aria-hidden="true">
      <div class="modal-dialog">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title" id="editClinicBedModalLabel">Edit Clinic Bed</h5>
            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
          </div>
          <div class="modal-body">
            <form id="editClinicBedForm">
              <input type="hidden" id="editClinicBedID">
              <div class="mb-3">
                <label for="editClinicBedClinic" class="form-label">Clinic</label>
                <input type="text" class="form-control" id="editClinicBedClinic" required>
              </div>
              <div class="mb-3">
                <label for="editClinicBedRoomNum" class="form-label">RoomNum</label>
                <input type="number" class="form-control" id="editClinicBedRoomNum" required>
              </div>
              <div class="mb-3">
                <label for="editClinicBedBedLetter" class="form-label">BedLetter (A/B)</label>
                <input type="text" class="form-control" id="editClinicBedBedLetter" required>
              </div>
              <div class="mb-3">
                <label for="editClinicBedUnit" class="form-label">Unit (1-7)</label>
                <input type="number" class="form-control" id="editClinicBedUnit" required>
              </div>
              <div class="mb-3">
                <label for="editClinicBedWing" class="form-label">Wing (Blue/Green)</label>
                <input type="text" class="form-control" id="editClinicBedWing" required>
              </div>
              <button type="submit" class="btn btn-primary w-100">Save</button>
            </form>
          </div>
        </div>
      </div>
    </div>
    <!-- Edit AdmittedTo Modal -->
    <div class="modal fade" id="editAdmittedToModal" tabindex="-1" aria-labelledby="editAdmittedToModalLabel" aria-hidden="true">
      <div class="modal-dialog">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title" id="editAdmittedToModalLabel">Edit AdmittedTo</h5>
            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
          </div>
          <div class="modal-body">
            <form id="editAdmittedToForm">
              <input type="hidden" id="editAdmittedToPID">
              <input type="hidden" id="editAdmittedToBedID">
              <div class="mb-3">
                <label for="editAdmittedToDateIN" class="form-label">Date_IN</label>
                <input type="date" class="form-control" id="editAdmittedToDateIN" required>
              </div>
              <div class="mb-3">
                <label for="editAdmittedToDateOUT" class="form-label">Date_OUT</label>
                <input type="date" class="form-control" id="editAdmittedToDateOUT">
              </div>
              <button type="submit" class="btn btn-primary w-100">Save</button>
            </form>
          </div>
        </div>
      </div>
    </div>
    <!-- Edit AttendsTo Modal -->
    <div class="modal fade" id="editAttendsToModal" tabindex="-1" aria-labelledby="editAttendsToModalLabel" aria-hidden="true">
      <div class="modal-dialog">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title" id="editAttendsToModalLabel">Edit AttendsTo</h5>
            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
          </div>
          <div class="modal-body">
            <form id="editAttendsToForm">
              <input type="hidden" id="editAttendsToNurseID">
              <input type="hidden" id="editAttendsToPID">
              <div class="mb-3">
                <label for="editAttendsToStartDate" class="form-label">StartDate</label>
                <input type="date" class="form-control" id="editAttendsToStartDate" required>
              </div>
              <div class="mb-3">
                <label for="editAttendsToEndDate" class="form-label">EndDate</label>
                <input type="date" class="form-control" id="editAttendsToEndDate">
              </div>
              <button type="submit" class="btn btn-primary w-100">Save</button>
            </form>
          </div>
        </div>
      </div>
    </div>
    <!-- Edit Diagnosis Modal -->
    <div class="modal fade" id="editDiagnosisModal" tabindex="-1" aria-labelledby="editDiagnosisModalLabel" aria-hidden="true">
      <div class="modal-dialog">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title" id="editDiagnosisModalLabel">Edit Diagnosis</h5>
            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
          </div>
          <div class="modal-body">
            <form id="editDiagnosisForm">
              <input type="hidden" id="editDiagnosisPID">
              <input type="hidden" id="editDiagnosisPhysicianID">
              <input type="hidden" id="editDiagnosisIllnessCode">
              <div class="mb-3">
                <label for="editDiagnosisDate" class="form-label">Date</label>
                <input type="date" class="form-control" id="editDiagnosisDate" required>
              </div>
              <div class="mb-3">
                <label for="editDiagnosisNotes" class="form-label">Notes</label>
                <input type="text" class="form-control" id="editDiagnosisNotes">
              </div>
              <div class="mb-3">
                <label for="editDiagnosisComment" class="form-label">Comment</label>
                <input type="text" class="form-control" id="editDiagnosisComment">
              </div>
              <button type="submit" class="btn btn-primary w-100">Save</button>
            </form>
          </div>
        </div>
      </div>
    </div>
    <!-- Edit ReactsWith Modal -->
    <div class="modal fade" id="editReactsWithModal" tabindex="-1" aria-labelledby="editReactsWithModalLabel" aria-hidden="true">
      <div class="modal-dialog">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title" id="editReactsWithModalLabel">Edit ReactsWith</h5>
            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
          </div>
          <div class="modal-body">
            <form id="editReactsWithForm">
              <input type="hidden" id="editReactsWithOldMedicine1">
              <input type="hidden" id="editReactsWithOldMedicine2">
              <div class="mb-3">
                <label for="editReactsWithMedicine1" class="form-label">Medicine 1</label>
                <select class="form-control" id="editReactsWithMedicine1" required></select>
              </div>
              <div class="mb-3">
                <label for="editReactsWithMedicine2" class="form-label">Medicine 2</label>
                <select class="form-control" id="editReactsWithMedicine2" required></select>
              </div>
              <div class="mb-3">
                <label for="editReactsWithSeverity" class="form-label">Severity (S/M/L/N)</label>
                <input type="text" class="form-control" id="editReactsWithSeverity" required>
              </div>
              <button type="submit" class="btn btn-primary w-100">Save</button>
            </form>
          </div>
        </div>
      </div>
    </div>
    <!-- Edit Prescription Modal -->
    <div class="modal fade" id="editPrescriptionModal" tabindex="-1" aria-labelledby="editPrescriptionModalLabel" aria-hidden="true">
      <div class="modal-dialog">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title" id="editPrescriptionModalLabel">Edit Prescription</h5>
            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
          </div>
          <div class="modal-body">
            <form id="editPrescriptionForm">
              <div class="mb-3">
                <label for="editPrescriptionID" class="form-label">PrescriptionID</label>
                <input type="number" class="form-control" id="editPrescriptionID" readonly>
              </div>
              <div class="mb-3">
                <label for="editPrescriptionPID" class="form-label">PID</label>
                <input type="number" class="form-control" id="editPrescriptionPID" required>
              </div>
              <div class="mb-3">
                <label for="editPrescriptionMedicineCode" class="form-label">MedicineCode</label>
                <input type="number" class="form-control" id="editPrescriptionMedicineCode" required>
              </div>
              <div class="mb-3">
                <label for="editPrescriptionPrescriber" class="form-label">Prescriber</label>
                <input type="number" class="form-control" id="editPrescriptionPrescriber" required>
              </div>
              <div class="mb-3">
                <label for="editPrescriptionDatePrescrbed" class="form-label">DatePrescrbed</label>
                <input type="date" class="form-control" id="editPrescriptionDatePrescrbed" required>
              </div>
              <div class="mb-3">
                <label for="editPrescriptionDateFilled" class="form-label">DateFilled</label>
                <input type="date" class="form-control" id="editPrescriptionDateFilled">
              </div>
              <div class="mb-3">
                <label for="editPrescriptionDosage" class="form-label">Dosage</label>
                <input type="text" class="form-control" id="editPrescriptionDosage" required>
              </div>
              <div class="mb-3">
                <label for="editPrescriptionDuration" class="form-label">Duration</label>
                <input type="text" class="form-control" id="editPrescriptionDuration" required>
              </div>
              <div class="mb-3">
                <label for="editPrescriptionFrequency" class="form-label">Frequency</label>
                <input type="text" class="form-control" id="editPrescriptionFrequency" required>
              </div>
              <div class="mb-3">
                <label for="editPrescriptionQuantity" class="form-label">Quantity</label>
                <input type="number" class="form-control" id="editPrescriptionQuantity" required>
              </div>
              <button type="submit" class="btn btn-primary w-100">Save</button>
            </form>
          </div>
        </div>
      </div>
    </div>
    <!-- Edit Surgery Modal -->
    <div class="modal fade" id="editSurgeryModal" tabindex="-1" aria-labelledby="editSurgeryModalLabel" aria-hidden="true">
      <div class="modal-dialog">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title" id="editSurgeryModalLabel">Edit Surgery</h5>
            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
          </div>
          <div class="modal-body">
            <form id="editSurgeryForm">
              <input type="hidden" id="editSurgeryOldPID">
              <input type="hidden" id="editSurgeryOldSurgeonID">
              <input type="hidden" id="editSurgeryOldSurgeryCode">
              <input type="hidden" id="editSurgeryOldDate">
              <div class="mb-3">
                <label for="editSurgeryPID" class="form-label">PID</label>
                <input type="number" class="form-control" id="editSurgeryPID" required>
              </div>
              <div class="mb-3">
                <label for="editSurgerySurgeonID" class="form-label">SurgeonID</label>
                <input type="number" class="form-control" id="editSurgerySurgeonID" required>
              </div>
              <div class="mb-3">
                <label for="editSurgerySurgeryCode" class="form-label">SurgeryCode</label>
                <input type="number" class="form-control" id="editSurgerySurgeryCode" required>
              </div>
              <div class="mb-3">
                <label for="editSurgeryDate" class="form-label">Date</label>
                <input type="date" class="form-control" id="editSurgeryDate" required>
              </div>
              <div class="mb-3">
                <label for="editSurgeryTheater" class="form-label">Theater</label>
                <input type="text" class="form-control" id="editSurgeryTheater" required>
              </div>
              <div class="mb-3">
                <label for="editSurgerySurgeryShift" class="form-label">SurgeryShift</label>
                <input type="text" class="form-control" id="editSurgerySurgeryShift">
              </div>
              <button type="submit" class="btn btn-primary w-100">Save</button>
            </form>
          </div>
        </div>
      </div>
    </div>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const tableSelector = document.getElementById('tableSelector');
            const tableContent = document.getElementById('tableContent');

            async function loadCorporations() {
                tableContent.innerHTML = `<div class='text-center'><div class='spinner-border'></div> Loading corporations...</div>`;
                try {
                    const response = await fetch('/api/corporations');
                    const corporations = await response.json();
                    let html = `
                        <h4>Corporations</h4>
                        <table class='table table-bordered'>
                            <thead>
                                <tr>
                                    <th>Name</th>
                                    <th>PercentOwn</th>
                                    <th>Headquarters Street</th>
                                    <th>Headquarters City</th>
                                    <th>Headquarters State</th>
                                    <th>Headquarters Zip</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody>
                    `;
                    for (const c of corporations) {
                        html += `
                            <tr>
                                <td>${c.Name}</td>
                                <td>${c.PercentOwn}</td>
                                <td>${c.HeadquartersStreet}</td>
                                <td>${c.HeadquartersCity}</td>
                                <td>${c.HeadquartersState}</td>
                                <td>${c.HeadquartersZip}</td>
                                <td>
                                    <button class='btn btn-primary btn-sm' onclick='editCorporation("${c.Name}")'>Edit</button>
                                    <button class='btn btn-danger btn-sm' onclick='deleteCorporation("${c.Name}")'>Delete</button>
                                </td>
                            </tr>
                        `;
                    }
                    html += `</tbody></table>`;
                    html += `
                        <h5>Add Corporation</h5>
                        <form id='addCorporationForm'>
                            <div class='mb-2'>
                                <input type='text' class='form-control' name='Name' placeholder='Name' required />
                            </div>
                            <div class='mb-2'>
                                <input type='number' class='form-control' name='PercentOwn' placeholder='Percent Own' step='0.01' required />
                            </div>
                            <div class='mb-2'>
                                <input type='text' class='form-control' name='HeadquartersStreet' placeholder='Headquarters Street' required />
                            </div>
                            <div class='mb-2'>
                                <input type='text' class='form-control' name='HeadquartersCity' placeholder='Headquarters City' required />
                            </div>
                            <div class='mb-2'>
                                <input type='text' class='form-control' name='HeadquartersState' placeholder='Headquarters State' required />
                            </div>
                            <div class='mb-2'>
                                <input type='text' class='form-control' name='HeadquartersZip' placeholder='Headquarters Zip' required />
                            </div>
                            <button type='submit' class='btn btn-success'>Add Corporation</button>
                        </form>
                        <div id='corporationFormMsg' class='mt-2'></div>
                    `;
                    tableContent.innerHTML = html;

                    document.getElementById('addCorporationForm').onsubmit = async function(e) {
                        e.preventDefault();
                        const form = e.target;
                        const data = {
                            Name: form.Name.value,
                            PercentOwn: form.PercentOwn.value,
                            HeadquartersStreet: form.HeadquartersStreet.value,
                            HeadquartersCity: form.HeadquartersCity.value,
                            HeadquartersState: form.HeadquartersState.value,
                            HeadquartersZip: form.HeadquartersZip.value
                        };
                        const resp = await fetch('/api/corporations', {
                            method: 'POST',
                            headers: { 'Content-Type': 'application/json' },
                            body: JSON.stringify(data)
                        });
                        const result = await resp.json();
                        document.getElementById('corporationFormMsg').innerHTML = `<div class='alert alert-info'>Corporation added successfully</div>`;
                        loadCorporations();
                    };

                    window.editCorporation = function(name) {
                        const c = corporations.find(corp => corp.Name === name);
                        if (!c) return;
                        document.getElementById('editCorporationName').value = c.Name;
                        document.getElementById('editCorporationPercentOwn').value = c.PercentOwn;
                        document.getElementById('editCorporationStreet').value = c.HeadquartersStreet;
                        document.getElementById('editCorporationCity').value = c.HeadquartersCity;
                        document.getElementById('editCorporationState').value = c.HeadquartersState;
                        document.getElementById('editCorporationZip').value = c.HeadquartersZip;
                        document.getElementById('editCorporationModalLabel').innerText = `Edit Corporation: ${c.Name}`;
                        bootstrap.Modal.getOrCreateInstance(document.getElementById('editCorporationModal')).show();
                    };
                    document.getElementById('editCorporationForm').onsubmit = async function(e) {
                        e.preventDefault();
                        const name = document.getElementById('editCorporationName').value;
                        const PercentOwn = document.getElementById('editCorporationPercentOwn').value;
                        const HeadquartersStreet = document.getElementById('editCorporationStreet').value;
                        const HeadquartersCity = document.getElementById('editCorporationCity').value;
                        const HeadquartersState = document.getElementById('editCorporationState').value;
                        const HeadquartersZip = document.getElementById('editCorporationZip').value;
                        await fetch(`/api/corporations/${name}`, {
                            method: 'PUT',
                            headers: { 'Content-Type': 'application/json' },
                            body: JSON.stringify({
                                PercentOwn,
                                HeadquartersStreet,
                                HeadquartersCity,
                                HeadquartersState,
                                HeadquartersZip
                            })
                        });
                        bootstrap.Modal.getOrCreateInstance(document.getElementById('editCorporationModal')).hide();
                        loadCorporations();
                    };
                    window.deleteCorporation = async function(name) {
                        if (!confirm('Delete this corporation?')) return;
                        await fetch(`/api/corporations/${name}`, { method: 'DELETE' });
                        loadCorporations();
                    };
                } catch (err) {
                    tableContent.innerHTML = `<div class='alert alert-danger'>Failed to load corporations.</div>`;
                }
            }

            async function loadClinics() {
                tableContent.innerHTML = `<div class='text-center'><div class='spinner-border'></div> Loading clinics...</div>`;
                try {
                    const response = await fetch('/api/clinics');
                    const clinics = await response.json();
                    let html = `
                        <h4>Clinics</h4>
                        <table class='table table-bordered'>
                            <thead>
                                <tr>
                                    <th>Name</th>
                                    <th>Street</th>
                                    <th>City</th>
                                    <th>State</th>
                                    <th>Zip</th>
                                    <th>OwnerID</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody>
                    `;
                    for (const c of clinics) {
                        html += `
                            <tr>
                                <td>${c.Name}</td>
                                <td>${c.Street}</td>
                                <td>${c.City}</td>
                                <td>${c.State}</td>
                                <td>${c.Zip}</td>
                                <td>${c.OwnerID || ''}</td>
                                <td>
                                    <button class='btn btn-primary btn-sm' onclick='editClinic("${c.Name}")'>Edit</button>
                                    <button class='btn btn-danger btn-sm' onclick='deleteClinic("${c.Name}")'>Delete</button>
                                </td>
                            </tr>
                        `;
                    }
                    html += `</tbody></table>`;
                    html += `
                        <h5>Add Clinic</h5>
                        <form id='addClinicForm'>
                            <div class='mb-2'>
                                <input type='text' class='form-control' name='Name' placeholder='Name' required />
                            </div>
                            <div class='mb-2'>
                                <input type='text' class='form-control' name='Street' placeholder='Street' required />
                            </div>
                            <div class='mb-2'>
                                <input type='text' class='form-control' name='City' placeholder='City' required />
                            </div>
                            <div class='mb-2'>
                                <input type='text' class='form-control' name='State' placeholder='State' required />
                            </div>
                            <div class='mb-2'>
                                <input type='text' class='form-control' name='Zip' placeholder='Zip' required />
                            </div>
                            <div class='mb-2'>
                                <input type='number' class='form-control' name='OwnerID' placeholder='OwnerID' />
                            </div>
                            <button type='submit' class='btn btn-success'>Add Clinic</button>
                        </form>
                        <div id='clinicFormMsg' class='mt-2'></div>
                    `;
                    tableContent.innerHTML = html;

                    document.getElementById('addClinicForm').onsubmit = async function(e) {
                        e.preventDefault();
                        const form = e.target;
                        const data = {
                            Name: form.Name.value,
                            Street: form.Street.value,
                            City: form.City.value,
                            State: form.State.value,
                            Zip: form.Zip.value,
                            OwnerID: form.OwnerID.value || null
                        };
                        const resp = await fetch('/api/clinics', {
                            method: 'POST',
                            headers: { 'Content-Type': 'application/json' },
                            body: JSON.stringify(data)
                        });
                        const result = await resp.json();
                        document.getElementById('clinicFormMsg').innerHTML = `<div class='alert alert-info'>Clinic added successfully</div>`;
                        loadClinics();
                    };

                    window.editClinic = function(name) {
                        const c = clinics.find(clinic => clinic.Name === name);
                        if (!c) return;
                        document.getElementById('editClinicName').value = c.Name;
                        document.getElementById('editClinicStreet').value = c.Street;
                        document.getElementById('editClinicCity').value = c.City;
                        document.getElementById('editClinicState').value = c.State;
                        document.getElementById('editClinicZip').value = c.Zip;
                        document.getElementById('editClinicOwnerID').value = c.OwnerID || '';
                        document.getElementById('editClinicModalLabel').innerText = `Edit Clinic: ${c.Name}`;
                        bootstrap.Modal.getOrCreateInstance(document.getElementById('editClinicModal')).show();
                    };
                    document.getElementById('editClinicForm').onsubmit = async function(e) {
                        e.preventDefault();
                        const name = document.getElementById('editClinicName').value;
                        const Street = document.getElementById('editClinicStreet').value;
                        const City = document.getElementById('editClinicCity').value;
                        const State = document.getElementById('editClinicState').value;
                        const Zip = document.getElementById('editClinicZip').value;
                        const OwnerID = document.getElementById('editClinicOwnerID').value || null;
                        await fetch(`/api/clinics/${name}`, {
                            method: 'PUT',
                            headers: { 'Content-Type': 'application/json' },
                            body: JSON.stringify({ Street, City, State, Zip, OwnerID })
                        });
                        bootstrap.Modal.getOrCreateInstance(document.getElementById('editClinicModal')).hide();
                        loadClinics();
                    };
                    window.deleteClinic = async function(name) {
                        if (!confirm('Delete this clinic?')) return;
                        await fetch(`/api/clinics/${name}`, { method: 'DELETE' });
                        loadClinics();
                    };
                } catch (err) {
                    tableContent.innerHTML = `<div class='alert alert-danger'>Failed to load clinics.</div>`;
                }
            }

            async function loadEmployees() {
                tableContent.innerHTML = `<div class='text-center'><div class='spinner-border'></div> Loading employees...</div>`;
                try {
                    const response = await fetch('/api/employees');
                    const employees = await response.json();
                    let html = `
                        <h4>Employees</h4>
                        <table class='table table-bordered'>
                            <thead>
                                <tr>
                                    <th>EmpID</th>
                                    <th>First Name</th>
                                    <th>Last Name</th>
                                    <th>SSN</th>
                                    <th>Salary</th>
                                    <th>Gender</th>
                                    <th>Type</th>
                                    <th>Phone</th>
                                    <th>Street</th>
                                    <th>City</th>
                                    <th>State</th>
                                    <th>Zip</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody>
                    `;
                    for (const e of employees) {
                        html += `
                            <tr>
                                <td>${e.empid}</td>
                                <td>${e.first_name || ''}</td>
                                <td>${e.last_name || ''}</td>
                                <td>${e.ssn || ''}</td>
                                <td>${e.salary || ''}</td>
                                <td>${e.gender || ''}</td>
                                <td>${e.employeetype || ''}</td>
                                <td>${e.phone || ''}</td>
                                <td>${e.street || ''}</td>
                                <td>${e.city || ''}</td>
                                <td>${e.state || ''}</td>
                                <td>${e.zip || ''}</td>
                                <td>
                                    <button class='btn btn-primary btn-sm' onclick='editEmployee(${e.empid})'>Edit</button>
                                    <button class='btn btn-danger btn-sm' onclick='deleteEmployee(${e.empid})'>Delete</button>
                                </td>
                            </tr>
                        `;
                    }
                    html += `</tbody></table>`;
                    html += `
                        <h5>Add Employee</h5>
                        <form id='addEmployeeForm'>
                            <div class='mb-2'>
                                <input type='text' class='form-control' name='First_Name' placeholder='First Name' required />
                            </div>
                            <div class='mb-2'>
                                <input type='text' class='form-control' name='Last_Name' placeholder='Last Name' required />
                            </div>
                            <div class='mb-2'>
                                <input type='text' class='form-control' name='SSN' placeholder='SSN' required />
                            </div>
                            <div class='mb-2'>
                                <input type='number' class='form-control' name='Salary' placeholder='Salary' step='0.01' />
                            </div>
                            <div class='mb-2'>
                                <select class='form-control' name='Gender' required>
                                    <option value=''>Select Gender</option>
                                    <option value='M'>Male</option>
                                    <option value='F'>Female</option>
                                </select>
                            </div>
                            <div class='mb-2'>
                                <select class='form-control' name='EmployeeType' id='employeeTypeSelect' required>
                                    <option value=''>Select Type</option>
                                    <option value='Physician'>Physician</option>
                                    <option value='Nurse'>Nurse</option>
                                    <option value='Surgeon'>Surgeon</option>
                                    <option value='Support'>Support</option>
                                </select>
                            </div>
                            <div class='mb-2'>
                                <input type='text' class='form-control' name='Phone' placeholder='Phone' required />
                            </div>
                            <div class='mb-2'>
                                <input type='text' class='form-control' name='Street' placeholder='Street' required />
                            </div>
                            <div class='mb-2'>
                                <input type='text' class='form-control' name='City' placeholder='City' required />
                            </div>
                            <div class='mb-2'>
                                <input type='text' class='form-control' name='State' placeholder='State' required />
                            </div>
                            <div class='mb-2'>
                                <input type='text' class='form-control' name='Zip' placeholder='Zip' required />
                            </div>
                            <div id='typeSpecificFields'></div>
                            <button type='submit' class='btn btn-success'>Add Employee</button>
                        </form>
                        <div id='employeeFormMsg' class='mt-2'></div>
                    `;
                    tableContent.innerHTML = html;

                    // Show/hide type-specific fields
                    const typeSelect = document.getElementById('employeeTypeSelect');
                    const typeFieldsDiv = document.getElementById('typeSpecificFields');
                    typeSelect.addEventListener('change', function() {
                        if (this.value === 'Nurse') {
                            typeFieldsDiv.innerHTML = `
                                <div class='mb-2'>
                                    <input type='text' class='form-control' name='Grade' placeholder='Grade' required />
                                </div>
                                <div class='mb-2'>
                                    <input type='number' class='form-control' name='Years' placeholder='Years' required />
                                </div>
                            `;
                        } else if (this.value === 'Physician') {
                            typeFieldsDiv.innerHTML = `
                                <div class='mb-2'>
                                    <input type='text' class='form-control' name='Specialty' placeholder='Specialty' required />
                                </div>
                                <div class='mb-2'>
                                    <input type='text' class='form-control' name='Type' placeholder='Type' required />
                                </div>
                            `;
                        } else if (this.value === 'Surgeon') {
                            typeFieldsDiv.innerHTML = `
                                <div class='mb-2'>
                                    <input type='text' class='form-control' name='Specialty' placeholder='Specialty' required />
                                </div>
                                <div class='mb-2'>
                                    <input type='text' class='form-control' name='ContractType' placeholder='Contract Type' required />
                                </div>
                                <div class='mb-2'>
                                    <input type='number' class='form-control' name='ContractDuration' placeholder='Contract Duration' required />
                                </div>
                                <div class='mb-2'>
                                    <input type='number' class='form-control' name='ContractAmount' placeholder='Contract Amount' step='0.01' />
                                </div>
                            `;
                        } else {
                            typeFieldsDiv.innerHTML = '';
                        }
                    });

                    document.getElementById('addEmployeeForm').onsubmit = async function(e) {
                        e.preventDefault();
                        const form = e.target;
                        const data = {
                            First_Name: form.First_Name.value,
                            Last_Name: form.Last_Name.value,
                            SSN: form.SSN.value,
                            Salary: form.Salary.value || null,
                            Gender: form.Gender.value,
                            EmployeeType: form.EmployeeType.value,
                            Phone: form.Phone.value,
                            Street: form.Street.value,
                            City: form.City.value,
                            State: form.State.value,
                            Zip: form.Zip.value
                        };
                        const resp = await fetch('/api/employees', {
                            method: 'POST',
                            headers: { 'Content-Type': 'application/json' },
                            body: JSON.stringify(data)
                        });
                        const result = await resp.json();
                        if (result.empid) {
                            // Cascade to type-specific table
                            if (form.EmployeeType.value === 'Nurse') {
                                await fetch('/api/nurses', {
                                    method: 'POST',
                                    headers: { 'Content-Type': 'application/json' },
                                    body: JSON.stringify({
                                        NurseID: result.empid,
                                        Grade: form.Grade.value,
                                        Years: form.Years.value
                                    })
                                });
                            } else if (form.EmployeeType.value === 'Physician') {
                                await fetch('/api/physicians', {
                                    method: 'POST',
                                    headers: { 'Content-Type': 'application/json' },
                                    body: JSON.stringify({
                                        PhysicianID: result.empid,
                                        Specialty: form.Specialty.value,
                                        Type: form.Type.value
                                    })
                                });
                            } else if (form.EmployeeType.value === 'Surgeon') {
                                await fetch('/api/surgeons', {
                                    method: 'POST',
                                    headers: { 'Content-Type': 'application/json' },
                                    body: JSON.stringify({
                                        SurgeonID: result.empid,
                                        Specialty: form.Specialty.value,
                                        ContractType: form.ContractType.value,
                                        ContractDuration: form.ContractDuration.value,
                                        ContractAmount: form.ContractAmount.value || null
                                    })
                                });
                            }
                        }
                        document.getElementById('employeeFormMsg').innerHTML = `<div class='alert alert-info'>Employee added successfully</div>`;
                        loadEmployees();
                    };

                    // Edit and delete logic
                    window.editEmployee = function(empid) {
                        const emp = employees.find(e => e.empid === empid);
                        if (!emp) return;
                        document.getElementById('editEmployeeId').value = emp.empid;
                        document.getElementById('editEmployeeFirstName').value = emp.first_name || '';
                        document.getElementById('editEmployeeLastName').value = emp.last_name || '';
                        document.getElementById('editEmployeeSSN').value = emp.ssn || '';
                        document.getElementById('editEmployeeSalary').value = emp.salary || '';
                        document.getElementById('editEmployeeGender').value = emp.gender || '';
                        document.getElementById('editEmployeeType').value = emp.employeetype || '';
                        document.getElementById('editEmployeePhone').value = emp.phone || '';
                        document.getElementById('editEmployeeStreet').value = emp.street || '';
                        document.getElementById('editEmployeeCity').value = emp.city || '';
                        document.getElementById('editEmployeeState').value = emp.state || '';
                        document.getElementById('editEmployeeZip').value = emp.zip || '';
                        // Type-specific fields
                        const typeFieldsDiv = document.getElementById('editEmployeeTypeSpecificFields');
                        typeFieldsDiv.innerHTML = '';
                        if (emp.employeetype === 'Nurse') {
                            typeFieldsDiv.innerHTML = `
                                <div class='mb-3'>
                                    <label for='editEmployeeGrade' class='form-label'>Grade</label>
                                    <input type='text' class='form-control' id='editEmployeeGrade' required />
                                </div>
                                <div class='mb-3'>
                                    <label for='editEmployeeYears' class='form-label'>Years</label>
                                    <input type='number' class='form-control' id='editEmployeeYears' required />
                                </div>
                            `;
                            // Fetch nurse details
                            fetch(`/api/nurses/${emp.empid}`).then(r => r.json()).then(nurse => {
                                document.getElementById('editEmployeeGrade').value = nurse.grade || '';
                                document.getElementById('editEmployeeYears').value = nurse.years || '';
                            });
                        } else if (emp.employeetype === 'Physician') {
                            typeFieldsDiv.innerHTML = `
                                <div class='mb-3'>
                                    <label for='editEmployeeSpecialty' class='form-label'>Specialty</label>
                                    <input type='text' class='form-control' id='editEmployeeSpecialty' required />
                                </div>
                                <div class='mb-3'>
                                    <label for='editEmployeeTypeField' class='form-label'>Type</label>
                                    <input type='text' class='form-control' id='editEmployeeTypeField' required />
                                </div>
                            `;
                            fetch(`/api/physicians/${emp.empid}`).then(r => r.json()).then(physician => {
                                document.getElementById('editEmployeeSpecialty').value = physician.specialty || '';
                                document.getElementById('editEmployeeTypeField').value = physician.type || '';
                            });
                        } else if (emp.employeetype === 'Surgeon') {
                            typeFieldsDiv.innerHTML = `
                                <div class='mb-3'>
                                    <label for='editEmployeeSpecialty' class='form-label'>Specialty</label>
                                    <input type='text' class='form-control' id='editEmployeeSpecialty' required />
                                </div>
                                <div class='mb-3'>
                                    <label for='editEmployeeContractType' class='form-label'>Contract Type</label>
                                    <input type='text' class='form-control' id='editEmployeeContractType' required />
                                </div>
                                <div class='mb-3'>
                                    <label for='editEmployeeContractDuration' class='form-label'>Contract Duration</label>
                                    <input type='number' class='form-control' id='editEmployeeContractDuration' required />
                                </div>
                                <div class='mb-3'>
                                    <label for='editEmployeeContractAmount' class='form-label'>Contract Amount</label>
                                    <input type='number' class='form-control' id='editEmployeeContractAmount' step='0.01' />
                                </div>
                            `;
                            fetch(`/api/surgeons/${emp.empid}`).then(r => r.json()).then(surgeon => {
                                document.getElementById('editEmployeeSpecialty').value = surgeon.specialty || '';
                                document.getElementById('editEmployeeContractType').value = surgeon.contracttype || '';
                                document.getElementById('editEmployeeContractDuration').value = surgeon.contractduration || '';
                                document.getElementById('editEmployeeContractAmount').value = surgeon.contractamount || '';
                            });
                        }
                        document.getElementById('editEmployeeModalLabel').innerText = `Edit Employee #${emp.empid}`;
                        bootstrap.Modal.getOrCreateInstance(document.getElementById('editEmployeeModal')).show();
                    };
                    document.getElementById('editEmployeeType').addEventListener('change', function() {
                        const typeFieldsDiv = document.getElementById('editEmployeeTypeSpecificFields');
                        typeFieldsDiv.innerHTML = '';
                        if (this.value === 'Nurse') {
                            typeFieldsDiv.innerHTML = `
                                <div class='mb-3'>
                                    <label for='editEmployeeGrade' class='form-label'>Grade</label>
                                    <input type='text' class='form-control' id='editEmployeeGrade' required />
                                </div>
                                <div class='mb-3'>
                                    <label for='editEmployeeYears' class='form-label'>Years</label>
                                    <input type='number' class='form-control' id='editEmployeeYears' required />
                                </div>
                            `;
                        } else if (this.value === 'Physician') {
                            typeFieldsDiv.innerHTML = `
                                <div class='mb-3'>
                                    <label for='editEmployeeSpecialty' class='form-label'>Specialty</label>
                                    <input type='text' class='form-control' id='editEmployeeSpecialty' required />
                                </div>
                                <div class='mb-3'>
                                    <label for='editEmployeeTypeField' class='form-label'>Type</label>
                                    <input type='text' class='form-control' id='editEmployeeTypeField' required />
                                </div>
                            `;
                        } else if (this.value === 'Surgeon') {
                            typeFieldsDiv.innerHTML = `
                                <div class='mb-3'>
                                    <label for='editEmployeeSpecialty' class='form-label'>Specialty</label>
                                    <input type='text' class='form-control' id='editEmployeeSpecialty' required />
                                </div>
                                <div class='mb-3'>
                                    <label for='editEmployeeContractType' class='form-label'>Contract Type</label>
                                    <input type='text' class='form-control' id='editEmployeeContractType' required />
                                </div>
                                <div class='mb-3'>
                                    <label for='editEmployeeContractDuration' class='form-label'>Contract Duration</label>
                                    <input type='number' class='form-control' id='editEmployeeContractDuration' required />
                                </div>
                                <div class='mb-3'>
                                    <label for='editEmployeeContractAmount' class='form-label'>Contract Amount</label>
                                    <input type='number' class='form-control' id='editEmployeeContractAmount' step='0.01' />
                                </div>
                            `;
                        }
                    });
                    document.getElementById('editEmployeeForm').onsubmit = async function(e) {
                        e.preventDefault();
                        const empid = document.getElementById('editEmployeeId').value;
                        const data = {
                            First_Name: document.getElementById('editEmployeeFirstName').value,
                            Last_Name: document.getElementById('editEmployeeLastName').value,
                            SSN: document.getElementById('editEmployeeSSN').value,
                            Salary: document.getElementById('editEmployeeSalary').value || null,
                            Gender: document.getElementById('editEmployeeGender').value,
                            EmployeeType: document.getElementById('editEmployeeType').value,
                            Phone: document.getElementById('editEmployeePhone').value,
                            Street: document.getElementById('editEmployeeStreet').value,
                            City: document.getElementById('editEmployeeCity').value,
                            State: document.getElementById('editEmployeeState').value,
                            Zip: document.getElementById('editEmployeeZip').value
                        };
                        await fetch(`/api/employees/${empid}`, {
                            method: 'PUT',
                            headers: { 'Content-Type': 'application/json' },
                            body: JSON.stringify(data)
                        });
                        // Type-specific update
                        if (data.EmployeeType === 'Nurse') {
                            await fetch(`/api/nurses/${empid}`, {
                                method: 'PUT',
                                headers: { 'Content-Type': 'application/json' },
                                body: JSON.stringify({
                                    Grade: document.getElementById('editEmployeeGrade').value,
                                    Years: document.getElementById('editEmployeeYears').value
                                })
                            });
                        } else if (data.EmployeeType === 'Physician') {
                            await fetch(`/api/physicians/${empid}`, {
                                method: 'PUT',
                                headers: { 'Content-Type': 'application/json' },
                                body: JSON.stringify({
                                    Specialty: document.getElementById('editEmployeeSpecialty').value,
                                    Type: document.getElementById('editEmployeeTypeField').value
                                })
                            });
                        } else if (data.EmployeeType === 'Surgeon') {
                            await fetch(`/api/surgeons/${empid}`, {
                                method: 'PUT',
                                headers: { 'Content-Type': 'application/json' },
                                body: JSON.stringify({
                                    Specialty: document.getElementById('editEmployeeSpecialty').value,
                                    ContractType: document.getElementById('editEmployeeContractType').value,
                                    ContractDuration: document.getElementById('editEmployeeContractDuration').value,
                                    ContractAmount: document.getElementById('editEmployeeContractAmount').value || null
                                })
                            });
                        }
                        bootstrap.Modal.getOrCreateInstance(document.getElementById('editEmployeeModal')).hide();
                        loadEmployees();
                    };

                    window.deleteEmployee = async function(empid) {
                        if (!confirm('Delete this employee?')) return;
                        await fetch(`/api/employees/${empid}`, { method: 'DELETE' });
                        loadEmployees();
                    };
                } catch (err) {
                    tableContent.innerHTML = `<div class='alert alert-danger'>Failed to load employees.</div>`;
                }
            }

            async function loadPhysicians() {
                tableContent.innerHTML = `<div class='text-center'><div class='spinner-border'></div> Loading physicians...</div>`;
                try {
                    const response = await fetch('/api/physicians');
                    const physicians = await response.json();
                    let html = `
                        <h4>Physicians</h4>
                        <table class='table table-bordered'>
                            <thead>
                                <tr>
                                    <th>PhysicianID</th>
                                    <th>Specialty</th>
                                    <th>Type</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody>
                    `;
                    for (const p of physicians) {
                        html += `
                            <tr>
                                <td>${p.physicianid}</td>
                                <td>${p.specialty || ''}</td>
                                <td>${p.type || ''}</td>
                                <td>
                                    <button class='btn btn-primary btn-sm' onclick='editPhysician(${p.physicianid})'>Edit</button>
                                    <button class='btn btn-danger btn-sm' onclick='deletePhysician(${p.physicianid})'>Delete</button>
                                </td>
                            </tr>
                        `;
                    }
                    html += `</tbody></table>`;
                    tableContent.innerHTML = html;
                    window.editPhysician = function(physicianid) {
                        const p = physicians.find(ph => ph.physicianid === physicianid);
                        if (!p) return;
                        document.getElementById('editPhysicianId').value = p.physicianid;
                        document.getElementById('editPhysicianSpecialty').value = p.specialty;
                        document.getElementById('editPhysicianType').value = p.type;
                        document.getElementById('editPhysicianModalLabel').innerText = `Edit Physician #${p.physicianid}`;
                        bootstrap.Modal.getOrCreateInstance(document.getElementById('editPhysicianModal')).show();
                    };
                    document.getElementById('editPhysicianForm').onsubmit = async function(e) {
                        e.preventDefault();
                        const physicianid = document.getElementById('editPhysicianId').value;
                        const specialty = document.getElementById('editPhysicianSpecialty').value;
                        const type = document.getElementById('editPhysicianType').value;
                        await fetch(`/api/physicians/${physicianid}`, {
                            method: 'PUT',
                            headers: { 'Content-Type': 'application/json' },
                            body: JSON.stringify({ Specialty: specialty, Type: type })
                        });
                        bootstrap.Modal.getOrCreateInstance(document.getElementById('editPhysicianModal')).hide();
                        loadPhysicians();
                    };
                } catch (err) {
                    tableContent.innerHTML = `<div class='alert alert-danger'>Failed to load physicians.</div>`;
                }
            }

            async function loadNurses() {
                tableContent.innerHTML = `<div class='text-center'><div class='spinner-border'></div> Loading nurses...</div>`;
                try {
                    const response = await fetch('/api/nurses');
                    const nurses = await response.json();
                    let html = `
                        <h4>Nurses</h4>
                        <table class='table table-bordered'>
                            <thead>
                                <tr>
                                    <th>NurseID</th>
                                    <th>Grade</th>
                                    <th>Years</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody>
                    `;
                    for (const n of nurses) {
                        html += `
                            <tr>
                                <td>${n.nurseid}</td>
                                <td>${n.grade || ''}</td>
                                <td>${n.years || ''}</td>
                                <td>
                                    <button class='btn btn-primary btn-sm' onclick='editNurse(${n.nurseid})'>Edit</button>
                                    <button class='btn btn-danger btn-sm' onclick='deleteNurse(${n.nurseid})'>Delete</button>
                                </td>
                            </tr>
                        `;
                    }
                    html += `</tbody></table>`;
                    tableContent.innerHTML = html;
                    window.editNurse = function(nurseid) {
                        const n = nurses.find(nu => nu.nurseid === nurseid);
                        if (!n) return;
                        document.getElementById('editNurseId').value = n.nurseid;
                        document.getElementById('editNurseGrade').value = n.grade;
                        document.getElementById('editNurseYears').value = n.years;
                        document.getElementById('editNurseModalLabel').innerText = `Edit Nurse #${n.nurseid}`;
                        bootstrap.Modal.getOrCreateInstance(document.getElementById('editNurseModal')).show();
                    };
                    document.getElementById('editNurseForm').onsubmit = async function(e) {
                        e.preventDefault();
                        const nurseid = document.getElementById('editNurseId').value;
                        const grade = document.getElementById('editNurseGrade').value;
                        const years = document.getElementById('editNurseYears').value;
                        await fetch(`/api/nurses/${nurseid}`, {
                            method: 'PUT',
                            headers: { 'Content-Type': 'application/json' },
                            body: JSON.stringify({ Grade: grade, Years: years })
                        });
                        bootstrap.Modal.getOrCreateInstance(document.getElementById('editNurseModal')).hide();
                        loadNurses();
                    };
                } catch (err) {
                    tableContent.innerHTML = `<div class='alert alert-danger'>Failed to load nurses.</div>`;
                }
            }

            async function loadSurgeons() {
                tableContent.innerHTML = `<div class='text-center'><div class='spinner-border'></div> Loading surgeons...</div>`;
                try {
                    const response = await fetch('/api/surgeons');
                    const surgeons = await response.json();
                    let html = `
                        <h4>Surgeons</h4>
                        <table class='table table-bordered'>
                            <thead>
                                <tr>
                                    <th>SurgeonID</th>
                                    <th>Specialty</th>
                                    <th>Contract Type</th>
                                    <th>Contract Duration</th>
                                    <th>Contract Amount</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody>
                    `;
                    for (const s of surgeons) {
                        html += `
                            <tr>
                                <td>${s.surgeonid}</td>
                                <td>${s.specialty || ''}</td>
                                <td>${s.contracttype || ''}</td>
                                <td>${s.contractduration || ''}</td>
                                <td>${s.contractamount || ''}</td>
                                <td>
                                    <button class='btn btn-primary btn-sm' onclick='editSurgeon(${s.surgeonid})'>Edit</button>
                                    <button class='btn btn-danger btn-sm' onclick='deleteSurgeon(${s.surgeonid})'>Delete</button>
                                </td>
                            </tr>
                        `;
                    }
                    html += `</tbody></table>`;
                    tableContent.innerHTML = html;
                    window.editSurgeon = function(surgeonid) {
                        const s = surgeons.find(su => su.surgeonid === surgeonid);
                        if (!s) return;
                        document.getElementById('editSurgeonId').value = s.surgeonid;
                        document.getElementById('editSurgeonSpecialty').value = s.specialty;
                        document.getElementById('editSurgeonContractType').value = s.contracttype;
                        document.getElementById('editSurgeonContractDuration').value = s.contractduration;
                        document.getElementById('editSurgeonContractAmount').value = s.contractamount;
                        document.getElementById('editSurgeonModalLabel').innerText = `Edit Surgeon #${s.surgeonid}`;
                        bootstrap.Modal.getOrCreateInstance(document.getElementById('editSurgeonModal')).show();
                    };
                    document.getElementById('editSurgeonForm').onsubmit = async function(e) {
                        e.preventDefault();
                        const surgeonid = document.getElementById('editSurgeonId').value;
                        const specialty = document.getElementById('editSurgeonSpecialty').value;
                        const contracttype = document.getElementById('editSurgeonContractType').value;
                        const contractduration = document.getElementById('editSurgeonContractDuration').value;
                        const contractamount = document.getElementById('editSurgeonContractAmount').value;
                        await fetch(`/api/surgeons/${surgeonid}`, {
                            method: 'PUT',
                            headers: { 'Content-Type': 'application/json' },
                            body: JSON.stringify({ Specialty: specialty, ContractType: contracttype, ContractDuration: contractduration, ContractAmount: contractamount })
                        });
                        bootstrap.Modal.getOrCreateInstance(document.getElementById('editSurgeonModal')).hide();
                        loadSurgeons();
                    };
                } catch (err) {
                    tableContent.innerHTML = `<div class='alert alert-danger'>Failed to load surgeons.</div>`;
                }
            }

            async function loadShifts() {
                tableContent.innerHTML = `<div class='text-center'><div class='spinner-border'></div> Loading shifts...</div>`;
                try {
                    const response = await fetch('/api/shifts');
                    const shifts = await response.json();
                    let html = `
                        <h4>Shifts</h4>
                        <table class='table table-bordered'>
                            <thead>
                                <tr>
                                    <th>EmpID</th>
                                    <th>Day</th>
                                    <th>BeginTime</th>
                                    <th>EndTime</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody>
                    `;
                    for (const s of shifts) {
                        html += `
                            <tr>
                                <td>${s.empid}</td>
                                <td>${s.day}</td>
                                <td>${s.begin_time}</td>
                                <td>${s.end_time}</td>
                                <td>
                                    <button class='btn btn-primary btn-sm' onclick='editShift(${s.empid}, "${s.day}")'>Edit</button>
                                    <button class='btn btn-danger btn-sm' onclick='deleteShift(${s.empid}, "${s.day}")'>Delete</button>
                                </td>
                            </tr>
                        `;
                    }
                    html += `</tbody></table>`;
                    html += `
                        <h5>Add Shift</h5>
                        <form id='addShiftForm'>
                            <div class='mb-2'>
                                <input type='number' class='form-control' name='EmpID' placeholder='EmpID' required />
                            </div>
                            <div class='mb-2'>
                                <select class='form-control' name='Day' required>
                                    <option value=''>Select Day</option>
                                    <option value='Monday'>Monday</option>
                                    <option value='Tuesday'>Tuesday</option>
                                    <option value='Wednesday'>Wednesday</option>
                                    <option value='Thursday'>Thursday</option>
                                    <option value='Friday'>Friday</option>
                                    <option value='Saturday'>Saturday</option>
                                    <option value='Sunday'>Sunday</option>
                                </select>
                            </div>
                            <div class='mb-2'>
                                <input type='time' class='form-control' name='BeginTime' required />
                            </div>
                            <div class='mb-2'>
                                <input type='time' class='form-control' name='EndTime' required />
                            </div>
                            <button type='submit' class='btn btn-success'>Add Shift</button>
                        </form>
                        <div id='shiftFormMsg' class='mt-2'></div>
                    `;
                    tableContent.innerHTML = html;

                    document.getElementById('addShiftForm').onsubmit = async function(e) {
                        e.preventDefault();
                        const form = e.target;
                        const data = {
                            EmpID: form.EmpID.value,
                            Day: form.Day.value,
                            BeginTime: form.BeginTime.value,
                            EndTime: form.EndTime.value
                        };
                        const resp = await fetch('/api/shifts', {
                            method: 'POST',
                            headers: { 'Content-Type': 'application/json' },
                            body: JSON.stringify(data)
                        });
                        const result = await resp.json();
                        document.getElementById('shiftFormMsg').innerHTML = `<div class='alert alert-info'>Shift added successfully</div>`;
                        loadShifts();
                    };
                } catch (err) {
                    tableContent.innerHTML = `<div class='alert alert-danger'>Failed to load shifts.</div>`;
                }
            }

            async function loadPatients() {
                tableContent.innerHTML = `<div class='text-center'><div class='spinner-border'></div> Loading patients...</div>`;
                try {
                    const response = await fetch('/api/patients');
                    const patients = await response.json();
                    let html = `
                        <h4>Patients</h4>
                        <table class='table table-bordered'>
                            <thead>
                                <tr>
                                    <th>PID</th>
                                    <th>PrimaryPhysician</th>
                                    <th>D_O_B</th>
                                    <th>SSN</th>
                                    <th>PFirstName</th>
                                    <th>PLastName</th>
                                    <th>Gender</th>
                                    <th>BloodType</th>
                                    <th>PStreet</th>
                                    <th>PCity</th>
                                    <th>PState</th>
                                    <th>PZip</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody>
                    `;
                    for (const p of patients) {
                        html += `
                            <tr>
                                <td>${p.pid}</td>
                                <td>${p.primaryphysician}</td>
                                <td>${p.d_o_b}</td>
                                <td>${p.ssn}</td>
                                <td>${p.first_name}</td>
                                <td>${p.last_name}</td>
                                <td>${p.gender}</td>
                                <td>${p.blood_type}</td>
                                <td>${p.street}</td>
                                <td>${p.city}</td>
                                <td>${p.state}</td>
                                <td>${p.zip}</td>
                                <td>
                                    <button class='btn btn-primary btn-sm' onclick='editPatient(${p.pid})'>Edit</button>
                                    <button class='btn btn-danger btn-sm' onclick='deletePatient(${p.pid})'>Delete</button>
                                </td>
                            </tr>
                        `;
                    }
                    html += `</tbody></table>`;
                    html += `
                        <h5>Add Patient</h5>
                        <form id='addPatientForm'>
                            <div class='mb-2'>
                                <input type='number' class='form-control' name='PrimaryPhysician' placeholder='Primary Physician EmpID' required />
                            </div>
                            <div class='mb-2'>
                                <input type='date' class='form-control' name='D_O_B' placeholder='Date of Birth' required />
                            </div>
                            <div class='mb-2'>
                                <input type='text' class='form-control' name='SSN' placeholder='SSN' required />
                            </div>
                            <div class='mb-2'>
                                <input type='text' class='form-control' name='PFirstName' placeholder='First Name' required />
                            </div>
                            <div class='mb-2'>
                                <input type='text' class='form-control' name='PLastName' placeholder='Last Name' required />
                            </div>
                            <div class='mb-2'>
                                <select class='form-control' name='Gender' required>
                                    <option value=''>Select Gender</option>
                                    <option value='M'>Male</option>
                                    <option value='F'>Female</option>
                                </select>
                            </div>
                            <div class='mb-2'>
                                <input type='text' class='form-control' name='BloodType' placeholder='Blood Type' required />
                            </div>
                            <div class='mb-2'>
                                <input type='text' class='form-control' name='PStreet' placeholder='Street' required />
                            </div>
                            <div class='mb-2'>
                                <input type='text' class='form-control' name='PCity' placeholder='City' required />
                            </div>
                            <div class='mb-2'>
                                <input type='text' class='form-control' name='PState' placeholder='State' required />
                            </div>
                            <div class='mb-2'>
                                <input type='text' class='form-control' name='PZip' placeholder='Zip' required />
                            </div>
                            <button type='submit' class='btn btn-success'>Add Patient</button>
                        </form>
                        <div id='patientFormMsg' class='mt-2'></div>
                    `;
                    tableContent.innerHTML = html;

                    document.getElementById('addPatientForm').onsubmit = async function(e) {
                        e.preventDefault();
                        const form = e.target;
                        const data = {
                            PrimaryPhysician: form.PrimaryPhysician.value,
                            D_O_B: form.D_O_B.value,
                            SSN: form.SSN.value,
                            PFirstName: form.PFirstName.value,
                            PLastName: form.PLastName.value,
                            Gender: form.Gender.value,
                            BloodType: form.BloodType.value,
                            PStreet: form.PStreet.value,
                            PCity: form.PCity.value,
                            PState: form.PState.value,
                            PZip: form.PZip.value
                        };
                        const resp = await fetch('/api/patients', {
                            method: 'POST',
                            headers: { 'Content-Type': 'application/json' },
                            body: JSON.stringify(data)
                        });
                        const result = await resp.json();
                        document.getElementById('patientFormMsg').innerHTML = `<div class='alert alert-info'>Patient added successfully</div>`;
                        loadPatients();
                    };

                    window.editPatient = function(pid) {
                        const p = patients.find(pt => pt.pid === pid);
                        if (!p) return;
                        document.getElementById('editPatientPID').value = p.pid;
                        document.getElementById('editPatientPrimaryPhysician').value = p.primaryphysician;
                        document.getElementById('editPatientDOB').value = p.d_o_b;
                        document.getElementById('editPatientSSN').value = p.ssn;
                        document.getElementById('editPatientFirstName').value = p.first_name;
                        document.getElementById('editPatientLastName').value = p.last_name;
                        document.getElementById('editPatientGender').value = p.gender;
                        document.getElementById('editPatientBloodType').value = p.blood_type;
                        document.getElementById('editPatientStreet').value = p.street;
                        document.getElementById('editPatientCity').value = p.city;
                        document.getElementById('editPatientState').value = p.state;
                        document.getElementById('editPatientZip').value = p.zip;
                        document.getElementById('editPatientModalLabel').innerText = `Edit Patient #${p.pid}`;
                        bootstrap.Modal.getOrCreateInstance(document.getElementById('editPatientModal')).show();
                    };
                    document.getElementById('editPatientForm').onsubmit = async function(e) {
                        e.preventDefault();
                        const pid = document.getElementById('editPatientPID').value;
                        const PrimaryPhysician = document.getElementById('editPatientPrimaryPhysician').value;
                        const D_O_B = document.getElementById('editPatientDOB').value;
                        const SSN = document.getElementById('editPatientSSN').value;
                        const PFirstName = document.getElementById('editPatientFirstName').value;
                        const PLastName = document.getElementById('editPatientLastName').value;
                        const Gender = document.getElementById('editPatientGender').value;
                        const BloodType = document.getElementById('editPatientBloodType').value;
                        const PStreet = document.getElementById('editPatientStreet').value;
                        const PCity = document.getElementById('editPatientCity').value;
                        const PState = document.getElementById('editPatientState').value;
                        const PZip = document.getElementById('editPatientZip').value;
                        await fetch(`/api/patients/${pid}`, {
                            method: 'PUT',
                            headers: { 'Content-Type': 'application/json' },
                            body: JSON.stringify({
                                PrimaryPhysician,
                                D_O_B,
                                SSN,
                                PFirstName,
                                PLastName,
                                Gender,
                                BloodType,
                                PStreet,
                                PCity,
                                PState,
                                PZip
                            })
                        });
                        bootstrap.Modal.getOrCreateInstance(document.getElementById('editPatientModal')).hide();
                        loadPatients();
                    };

                    window.deletePatient = async function(pid) {
                        if (!confirm('Delete this patient?')) return;
                        await fetch(`/api/patients/${pid}`, { method: 'DELETE' });
                        loadPatients();
                    };
                } catch (err) {
                    tableContent.innerHTML = `<div class='alert alert-danger'>Failed to load patients.</div>`;
                }
            }

            async function loadMedicalData() {
                tableContent.innerHTML = `<div class='text-center'><div class='spinner-border'></div> Loading medical data...</div>`;
                try {
                    const response = await fetch('/api/medicaldata');
                    const records = await response.json();
                    let html = `
                        <h4>Medical Data</h4>
                        <table class='table table-bordered'>
                            <thead>
                                <tr>
                                    <th>PID</th>
                                    <th>BloodSugar</th>
                                    <th>Cholesterol</th>
                                    <th>Triglycerides</th>
                                    <th>HDL</th>
                                    <th>LDL</th>
                                    <th>LastUpdate</th>
                                    <th>Heart_Risk</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody>
                    `;
                    for (const m of records) {
                        html += `
                            <tr>
                                <td>${m.pid}</td>
                                <td>${m.blood_sugar || ''}</td>
                                <td>${m.cholesterol || ''}</td>
                                <td>${m.triglycerides || ''}</td>
                                <td>${m.hdl || ''}</td>
                                <td>${m.ldl || ''}</td>
                                <td>${m.last_update || ''}</td>
                                <td>${m.heart_risk || ''}</td>
                                <td>
                                    <button class='btn btn-primary btn-sm' onclick='editMedicalData(${m.pid})'>Edit</button>
                                    <button class='btn btn-danger btn-sm' onclick='deleteMedicalData(${m.pid})'>Delete</button>
                                </td>
                            </tr>
                        `;
                    }
                    html += `</tbody></table>`;
                    html += `
                        <h5>Add Medical Data</h5>
                        <form id='addMedicalDataForm'>
                            <div class='mb-2'>
                                <input type='number' class='form-control' name='PID' placeholder='Patient ID' required />
                            </div>
                            <div class='mb-2'>
                                <input type='number' class='form-control' name='BloodSugar' placeholder='Blood Sugar' step='0.01' />
                            </div>
                            <div class='mb-2'>
                                <input type='number' class='form-control' name='Cholesterol' placeholder='Cholesterol' step='0.01' />
                            </div>
                            <div class='mb-2'>
                                <input type='number' class='form-control' name='Triglycerides' placeholder='Triglycerides' step='0.01' />
                            </div>
                            <div class='mb-2'>
                                <input type='number' class='form-control' name='HDL' placeholder='HDL' step='0.01' />
                            </div>
                            <div class='mb-2'>
                                <input type='number' class='form-control' name='LDL' placeholder='LDL' step='0.01' />
                            </div>
                            <div class='mb-2'>
                                <input type='date' class='form-control' name='LastUpdate' placeholder='Last Update' required />
                            </div>
                            <div class='mb-2'>
                                <input type='text' class='form-control' name='Heart_Risk' placeholder='Heart Risk' />
                            </div>
                            <button type='submit' class='btn btn-success'>Add Medical Data</button>
                        </form>
                        <div id='medicalDataFormMsg' class='mt-2'></div>
                    `;
                    tableContent.innerHTML = html;

                    document.getElementById('addMedicalDataForm').onsubmit = async function(e) {
                        e.preventDefault();
                        const form = e.target;
                        const data = {
                            PID: form.PID.value,
                            BloodSugar: form.BloodSugar.value || null,
                            Cholesterol: form.Cholesterol.value || null,
                            Triglycerides: form.Triglycerides.value || null,
                            HDL: form.HDL.value || null,
                            LDL: form.LDL.value || null,
                            LastUpdate: form.LastUpdate.value,
                            Heart_Risk: form.Heart_Risk.value || null
                        };
                        const resp = await fetch('/api/medicaldata', {
                            method: 'POST',
                            headers: { 'Content-Type': 'application/json' },
                            body: JSON.stringify(data)
                        });
                        const result = await resp.json();
                        document.getElementById('medicalDataFormMsg').innerHTML = `<div class='alert alert-info'>Medical data added successfully</div>`;
                        loadMedicalData();
                    };

                    window.editMedicalData = function(pid) {
                        const m = records.find(md => md.pid === pid);
                        if (!m) return;
                        document.getElementById('editMedicalDataPID').value = m.pid;
                        document.getElementById('editMedicalDataBloodSugar').value = m.blood_sugar || '';
                        document.getElementById('editMedicalDataCholesterol').value = m.cholesterol || '';
                        document.getElementById('editMedicalDataTriglycerides').value = m.triglycerides || '';
                        document.getElementById('editMedicalDataHDL').value = m.hdl || '';
                        document.getElementById('editMedicalDataLDL').value = m.ldl || '';
                        document.getElementById('editMedicalDataLastUpdate').value = m.last_update ? m.last_update.split('T')[0] : '';
                        document.getElementById('editMedicalDataHeartRisk').value = m.heart_risk || '';
                        document.getElementById('editMedicalDataModalLabel').innerText = `Edit Medical Data for PID ${m.pid}`;
                        bootstrap.Modal.getOrCreateInstance(document.getElementById('editMedicalDataModal')).show();
                    };
                    document.getElementById('editMedicalDataForm').onsubmit = async function(e) {
                        e.preventDefault();
                        const pid = document.getElementById('editMedicalDataPID').value;
                        const BloodSugar = document.getElementById('editMedicalDataBloodSugar').value || null;
                        const Cholesterol = document.getElementById('editMedicalDataCholesterol').value || null;
                        const Triglycerides = document.getElementById('editMedicalDataTriglycerides').value || null;
                        const HDL = document.getElementById('editMedicalDataHDL').value || null;
                        const LDL = document.getElementById('editMedicalDataLDL').value || null;
                        const LastUpdate = document.getElementById('editMedicalDataLastUpdate').value;
                        const Heart_Risk = document.getElementById('editMedicalDataHeartRisk').value || null;
                        await fetch(`/api/medicaldata/${pid}`, {
                            method: 'PUT',
                            headers: { 'Content-Type': 'application/json' },
                            body: JSON.stringify({
                                BloodSugar,
                                Cholesterol,
                                Triglycerides,
                                HDL,
                                LDL,
                                LastUpdate,
                                Heart_Risk
                            })
                        });
                        bootstrap.Modal.getOrCreateInstance(document.getElementById('editMedicalDataModal')).hide();
                        loadMedicalData();
                    };

                    window.deleteMedicalData = async function(pid) {
                        if (!confirm('Delete this medical data?')) return;
                        await fetch(`/api/medicaldata/${pid}`, { method: 'DELETE' });
                        loadMedicalData();
                    };
                } catch (err) {
                    tableContent.innerHTML = `<div class='alert alert-danger'>Failed to load medical data.</div>`;
                }
            }

            async function loadAllergies() {
                tableContent.innerHTML = `<div class='text-center'><div class='spinner-border'></div> Loading allergies...</div>`;
                try {
                    const response = await fetch('/api/allergies');
                    const allergies = await response.json();
                    let html = `
                        <h4>Allergies</h4>
                        <table class='table table-bordered'>
                            <thead>
                                <tr>
                                    <th>AllergyCode</th>
                                    <th>Description</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody>
                    `;
                    for (const a of allergies) {
                        html += `
                            <tr>
                                <td>${a.allergycode}</td>
                                <td>${a.description || ''}</td>
                                <td>
                                    <button class='btn btn-primary btn-sm' onclick='editAllergy(${a.allergycode})'>Edit</button>
                                    <button class='btn btn-danger btn-sm' onclick='deleteAllergy(${a.allergycode})'>Delete</button>
                                </td>
                            </tr>
                        `;
                    }
                    html += `</tbody></table>`;
                    html += `
                        <h5>Add Allergy</h5>
                        <form id='addAllergyForm'>
                            <div class='mb-2'>
                                <input type='number' class='form-control' name='AllergyCode' placeholder='Allergy Code' required />
                            </div>
                            <div class='mb-2'>
                                <input type='text' class='form-control' name='Description' placeholder='Description' required />
                            </div>
                            <button type='submit' class='btn btn-success'>Add Allergy</button>
                        </form>
                        <div id='allergyFormMsg' class='mt-2'></div>
                    `;
                    tableContent.innerHTML = html;

                    document.getElementById('addAllergyForm').onsubmit = async function(e) {
                        e.preventDefault();
                        const form = e.target;
                        const data = {
                            AllergyCode: form.AllergyCode.value,
                            Description: form.Description.value
                        };
                        const resp = await fetch('/api/allergies', {
                            method: 'POST',
                            headers: { 'Content-Type': 'application/json' },
                            body: JSON.stringify(data)
                        });
                        const result = await resp.json();
                        document.getElementById('allergyFormMsg').innerHTML = `<div class='alert alert-info'>Allergy added successfully</div>`;
                        loadAllergies();
                    };

                    window.editAllergy = function(code) {
                        const a = allergies.find(al => al.allergycode === code);
                        if (!a) return;
                        document.getElementById('editAllergyCode').value = a.allergycode;
                        document.getElementById('editAllergyDescription').value = a.description;
                        document.getElementById('editAllergyModalLabel').innerText = `Edit Allergy #${a.allergycode}`;
                        bootstrap.Modal.getOrCreateInstance(document.getElementById('editAllergyModal')).show();
                    };
                    document.getElementById('editAllergyForm').onsubmit = async function(e) {
                        e.preventDefault();
                        const code = document.getElementById('editAllergyCode').value;
                        const Description = document.getElementById('editAllergyDescription').value;
                        await fetch(`/api/allergies/${code}`, {
                            method: 'PUT',
                            headers: { 'Content-Type': 'application/json' },
                            body: JSON.stringify({ Description })
                        });
                        bootstrap.Modal.getOrCreateInstance(document.getElementById('editAllergyModal')).hide();
                        loadAllergies();
                    };

                    window.deleteAllergy = async function(code) {
                        if (!confirm('Delete this allergy?')) return;
                        await fetch(`/api/allergies/${code}`, { method: 'DELETE' });
                        loadAllergies();
                    };
                } catch (err) {
                    tableContent.innerHTML = `<div class='alert alert-danger'>Failed to load allergies.</div>`;
                }
            }

            async function loadIllnesses() {
                tableContent.innerHTML = `<div class='text-center'><div class='spinner-border'></div> Loading illnesses...</div>`;
                try {
                    const response = await fetch('/api/illnesses');
                    const illnesses = await response.json();
                    let html = `
                        <h4>Illnesses</h4>
                        <table class='table table-bordered'>
                            <thead>
                                <tr>
                                    <th>IllnessCode</th>
                                    <th>Description</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody>
                    `;
                    for (const i of illnesses) {
                        html += `
                            <tr>
                                <td>${i.IllnessCode}</td>
                                <td>${i.Description || ''}</td>
                                <td>
                                    <button class='btn btn-primary btn-sm' onclick='editIllness(${i.IllnessCode})'>Edit</button>
                                    <button class='btn btn-danger btn-sm' onclick='deleteIllness(${i.IllnessCode})'>Delete</button>
                                </td>
                            </tr>
                        `;
                    }
                    html += `</tbody></table>`;
                    html += `
                        <h5>Add Illness</h5>
                        <form id='addIllnessForm'>
                            <div class='mb-2'>
                                <input type='number' class='form-control' name='IllnessCode' placeholder='Illness Code' required />
                            </div>
                            <div class='mb-2'>
                                <input type='text' class='form-control' name='Description' placeholder='Description' required />
                            </div>
                            <button type='submit' class='btn btn-success'>Add Illness</button>
                        </form>
                        <div id='illnessFormMsg' class='mt-2'></div>
                    `;
                    tableContent.innerHTML = html;

                    document.getElementById('addIllnessForm').onsubmit = async function(e) {
                        e.preventDefault();
                        const form = e.target;
                        const data = {
                            IllnessCode: form.IllnessCode.value,
                            Description: form.Description.value
                        };
                        const resp = await fetch('/api/illnesses', {
                            method: 'POST',
                            headers: { 'Content-Type': 'application/json' },
                            body: JSON.stringify(data)
                        });
                        const result = await resp.json();
                        document.getElementById('illnessFormMsg').innerHTML = `<div class='alert alert-info'>Illness added successfully</div>`;
                        loadIllnesses();
                    };

                    window.editIllness = function(code) {
                        const i = illnesses.find(il => il.IllnessCode === code);
                        if (!i) return;
                        document.getElementById('editIllnessCode').value = i.IllnessCode;
                        document.getElementById('editIllnessDescription').value = i.Description;
                        document.getElementById('editIllnessModalLabel').innerText = `Edit Illness #${i.IllnessCode}`;
                        bootstrap.Modal.getOrCreateInstance(document.getElementById('editIllnessModal')).show();
                    };
                    document.getElementById('editIllnessForm').onsubmit = async function(e) {
                        e.preventDefault();
                        const code = document.getElementById('editIllnessCode').value;
                        const Description = document.getElementById('editIllnessDescription').value;
                        await fetch(`/api/illnesses/${code}`, {
                            method: 'PUT',
                            headers: { 'Content-Type': 'application/json' },
                            body: JSON.stringify({ Description })
                        });
                        bootstrap.Modal.getOrCreateInstance(document.getElementById('editIllnessModal')).hide();
                        loadIllnesses();
                    };

                    window.deleteIllness = async function(code) {
                        if (!confirm('Delete this illness?')) return;
                        await fetch(`/api/illnesses/${code}`, { method: 'DELETE' });
                        loadIllnesses();
                    };
                } catch (err) {
                    tableContent.innerHTML = `<div class='alert alert-danger'>Failed to load illnesses.</div>`;
                }
            }

            async function loadClinicBeds() {
                tableContent.innerHTML = `<div class='text-center'><div class='spinner-border'></div> Loading clinic beds...</div>`;
                try {
                    const response = await fetch('/api/clinicbeds');
                    const beds = await response.json();
                    let html = `
                        <h4>Clinic Beds</h4>
                        <table class='table table-bordered'>
                            <thead>
                                <tr>
                                    <th>BedID</th><th>Clinic</th><th>RoomNum</th><th>BedLetter</th><th>Unit</th><th>Wing</th><th>Actions</th>
                                </tr>
                            </thead>
                            <tbody>
                    `;
                    for (const b of beds) {
                        html += `
                            <tr>
                                <td>${b.BedID}</td>
                                <td>${b.Clinic}</td>
                                <td>${b.RoomNum}</td>
                                <td>${b.BedLetter}</td>
                                <td>${b.Unit}</td>
                                <td>${b.Wing}</td>
                                <td>
                                    <button class='btn btn-primary btn-sm' onclick='editClinicBed(${b.BedID})'>Edit</button>
                                    <button class='btn btn-danger btn-sm' onclick='deleteClinicBed(${b.BedID})'>Delete</button>
                                </td>
                            </tr>
                        `;
                    }
                    html += `</tbody></table>`;
                    html += `
                        <h5>Add Clinic Bed</h5>
                        <form id='addClinicBedForm'>
                            <div class='mb-2'><input type='number' class='form-control' name='BedID' placeholder='BedID' required /></div>
                            <div class='mb-2'><input type='text' class='form-control' name='Clinic' placeholder='Clinic' required /></div>
                            <div class='mb-2'><input type='number' class='form-control' name='RoomNum' placeholder='RoomNum' required /></div>
                            <div class='mb-2'><input type='text' class='form-control' name='BedLetter' placeholder='BedLetter (A/B)' required /></div>
                            <div class='mb-2'><input type='number' class='form-control' name='Unit' placeholder='Unit (1-7)' required /></div>
                            <div class='mb-2'><input type='text' class='form-control' name='Wing' placeholder='Wing (Blue/Green)' required /></div>
                            <button type='submit' class='btn btn-success'>Add Clinic Bed</button>
                        </form>
                        <div id='clinicBedFormMsg' class='mt-2'></div>
                    `;
                    tableContent.innerHTML = html;
                    document.getElementById('addClinicBedForm').onsubmit = async function(e) {
                        e.preventDefault();
                        const form = e.target;
                        const data = {
                            BedID: form.BedID.value,
                            Clinic: form.Clinic.value,
                            RoomNum: form.RoomNum.value,
                            BedLetter: form.BedLetter.value,
                            Unit: form.Unit.value,
                            Wing: form.Wing.value
                        };
                        const resp = await fetch('/api/clinicbeds', {
                            method: 'POST',
                            headers: { 'Content-Type': 'application/json' },
                            body: JSON.stringify(data)
                        });
                        const result = await resp.json();
                        document.getElementById('clinicBedFormMsg').innerHTML = `<div class='alert alert-info'>Clinic bed added successfully</div>`;
                        loadClinicBeds();
                    };
                    window.editClinicBed = function(bedid) {
                        const b = beds.find(bed => bed.BedID === bedid);
                        if (!b) return;
                        document.getElementById('editClinicBedID').value = b.BedID;
                        document.getElementById('editClinicBedClinic').value = b.Clinic;
                        document.getElementById('editClinicBedRoomNum').value = b.RoomNum;
                        document.getElementById('editClinicBedBedLetter').value = b.BedLetter;
                        document.getElementById('editClinicBedUnit').value = b.Unit;
                        document.getElementById('editClinicBedWing').value = b.Wing;
                        document.getElementById('editClinicBedModalLabel').innerText = `Edit Clinic Bed #${b.BedID}`;
                        bootstrap.Modal.getOrCreateInstance(document.getElementById('editClinicBedModal')).show();
                    };
                    document.getElementById('editClinicBedForm').onsubmit = async function(e) {
                        e.preventDefault();
                        const bedid = document.getElementById('editClinicBedID').value;
                        const Clinic = document.getElementById('editClinicBedClinic').value;
                        const RoomNum = document.getElementById('editClinicBedRoomNum').value;
                        const BedLetter = document.getElementById('editClinicBedBedLetter').value;
                        const Unit = document.getElementById('editClinicBedUnit').value;
                        const Wing = document.getElementById('editClinicBedWing').value;
                        await fetch(`/api/clinicbeds/${bedid}`, {
                            method: 'PUT',
                            headers: { 'Content-Type': 'application/json' },
                            body: JSON.stringify({ Clinic, RoomNum, BedLetter, Unit, Wing })
                        });
                        bootstrap.Modal.getOrCreateInstance(document.getElementById('editClinicBedModal')).hide();
                        loadClinicBeds();
                    };
                    window.deleteClinicBed = async function(bedid) {
                        if (!confirm('Delete this clinic bed?')) return;
                        await fetch(`/api/clinicbeds/${bedid}`, { method: 'DELETE' });
                        loadClinicBeds();
                    };
                } catch (err) {
                    tableContent.innerHTML = `<div class='alert alert-danger'>Failed to load clinic beds.</div>`;
                }
            }

            async function loadAdmittedTo() {
                tableContent.innerHTML = `<div class='text-center'><div class='spinner-border'></div> Loading AdmittedTo records...</div>`;
                try {
                    const response = await fetch('/api/admittedto');
                    const records = await response.json();
                    let html = `
                        <h4>AdmittedTo</h4>
                        <table class='table table-bordered'>
                            <thead><tr><th>PID</th><th>BedID</th><th>Date_IN</th><th>Date_OUT</th><th>Actions</th></tr></thead><tbody>`;
                    for (const r of records) {
                        html += `<tr><td>${r.PID}</td><td>${r.BedID}</td><td>${r.Date_IN || ''}</td><td>${r.Date_OUT || ''}</td>
                        <td><button class='btn btn-primary btn-sm' onclick='editAdmittedTo(${r.PID},${r.BedID})'>Edit</button>
                        <button class='btn btn-danger btn-sm' onclick='deleteAdmittedTo(${r.PID},${r.BedID})'>Delete</button></td></tr>`;
                    }
                    html += `</tbody></table>`;
                    html += `<h5>Add AdmittedTo</h5>
                        <form id='addAdmittedToForm'>
                            <div class='mb-2'><input type='number' class='form-control' name='PID' placeholder='PID' required /></div>
                            <div class='mb-2'><input type='number' class='form-control' name='BedID' placeholder='BedID' required /></div>
                            <div class='mb-2'><input type='date' class='form-control' name='Date_IN' placeholder='Date_IN' required /></div>
                            <div class='mb-2'><input type='date' class='form-control' name='Date_OUT' placeholder='Date_OUT' /></div>
                            <button type='submit' class='btn btn-success'>Add AdmittedTo</button>
                        </form><div id='admittedToFormMsg' class='mt-2'></div>`;
                    tableContent.innerHTML = html;
                    document.getElementById('addAdmittedToForm').onsubmit = async function(e) {
                        e.preventDefault();
                        const form = e.target;
                        const data = {
                            PID: form.PID.value,
                            BedID: form.BedID.value,
                            Date_IN: form.Date_IN.value,
                            Date_OUT: form.Date_OUT.value || null
                        };
                        await fetch('/api/admittedto', {
                            method: 'POST', headers: { 'Content-Type': 'application/json' }, body: JSON.stringify(data)
                        });
                        document.getElementById('admittedToFormMsg').innerHTML = `<div class='alert alert-info'>AdmittedTo added successfully</div>`;
                        loadAdmittedTo();
                    };
                    window.editAdmittedTo = function(pid, bedid) {
                        const r = records.find(x => x.PID === pid && x.BedID === bedid);
                        if (!r) return;
                        document.getElementById('editAdmittedToPID').value = r.PID;
                        document.getElementById('editAdmittedToBedID').value = r.BedID;
                        document.getElementById('editAdmittedToDateIN').value = r.Date_IN ? r.Date_IN.split('T')[0] : '';
                        document.getElementById('editAdmittedToDateOUT').value = r.Date_OUT ? r.Date_OUT.split('T')[0] : '';
                        document.getElementById('editAdmittedToModalLabel').innerText = `Edit AdmittedTo (PID: ${r.PID}, BedID: ${r.BedID})`;
                        bootstrap.Modal.getOrCreateInstance(document.getElementById('editAdmittedToModal')).show();
                    };
                    document.getElementById('editAdmittedToForm').onsubmit = async function(e) {
                        e.preventDefault();
                        const pid = document.getElementById('editAdmittedToPID').value;
                        const bedid = document.getElementById('editAdmittedToBedID').value;
                        const Date_IN = document.getElementById('editAdmittedToDateIN').value;
                        const Date_OUT = document.getElementById('editAdmittedToDateOUT').value || null;
                        await fetch(`/api/admittedto/${pid}/${bedid}`, {
                            method: 'PUT',
                            headers: { 'Content-Type': 'application/json' },
                            body: JSON.stringify({ Date_IN, Date_OUT })
                        });
                        bootstrap.Modal.getOrCreateInstance(document.getElementById('editAdmittedToModal')).hide();
                        loadAdmittedTo();
                    };
                    window.deleteAdmittedTo = async function(pid, bedid) {
                        if (!confirm('Delete this AdmittedTo record?')) return;
                        await fetch(`/api/admittedto/${pid}/${bedid}`, { method: 'DELETE' });
                        loadAdmittedTo();
                    };
                } catch (err) {
                    tableContent.innerHTML = `<div class='alert alert-danger'>Failed to load AdmittedTo records.</div>`;
                }
            }

            async function loadAttendsTo() {
                tableContent.innerHTML = `<div class='text-center'><div class='spinner-border'></div> Loading AttendsTo records...</div>`;
                try {
                    const response = await fetch('/api/attendsto');
                    const records = await response.json();
                    let html = `<h4>AttendsTo</h4><table class='table table-bordered'><thead><tr><th>NurseID</th><th>PID</th><th>StartDate</th><th>EndDate</th><th>Actions</th></tr></thead><tbody>`;
                    for (const r of records) {
                        html += `<tr><td>${r.NurseID}</td><td>${r.PID}</td><td>${r.StartDate || ''}</td><td>${r.EndDate || ''}</td>
                        <td><button class='btn btn-primary btn-sm' onclick='editAttendsTo(${r.NurseID},${r.PID})'>Edit</button>
                        <button class='btn btn-danger btn-sm' onclick='deleteAttendsTo(${r.NurseID},${r.PID})'>Delete</button></td></tr>`;
                    }
                    html += `</tbody></table>`;
                    html += `<h5>Add AttendsTo</h5><form id='addAttendsToForm'><div class='mb-2'><input type='number' class='form-control' name='NurseID' placeholder='NurseID' required /></div><div class='mb-2'><input type='number' class='form-control' name='PID' placeholder='PID' required /></div><div class='mb-2'><input type='date' class='form-control' name='StartDate' placeholder='StartDate' required /></div><div class='mb-2'><input type='date' class='form-control' name='EndDate' placeholder='EndDate' /></div><button type='submit' class='btn btn-success'>Add AttendsTo</button></form><div id='attendsToFormMsg' class='mt-2'></div>`;
                    tableContent.innerHTML = html;
                    document.getElementById('addAttendsToForm').onsubmit = async function(e) {
                        e.preventDefault();
                        const form = e.target;
                        const data = { NurseID: form.NurseID.value, PID: form.PID.value, StartDate: form.StartDate.value, EndDate: form.EndDate.value || null };
                        await fetch('/api/attendsto', { method: 'POST', headers: { 'Content-Type': 'application/json' }, body: JSON.stringify(data) });
                        document.getElementById('attendsToFormMsg').innerHTML = `<div class='alert alert-info'>AttendsTo added successfully</div>`;
                        loadAttendsTo();
                    };
                    window.editAttendsTo = function(nurseid, pid) {
                        const r = records.find(x => x.NurseID === nurseid && x.PID === pid);
                        if (!r) return;
                        document.getElementById('editAttendsToNurseID').value = r.NurseID;
                        document.getElementById('editAttendsToPID').value = r.PID;
                        document.getElementById('editAttendsToStartDate').value = r.StartDate ? r.StartDate.split('T')[0] : '';
                        document.getElementById('editAttendsToEndDate').value = r.EndDate ? r.EndDate.split('T')[0] : '';
                        document.getElementById('editAttendsToModalLabel').innerText = `Edit AttendsTo (NurseID: ${r.NurseID}, PID: ${r.PID})`;
                        bootstrap.Modal.getOrCreateInstance(document.getElementById('editAttendsToModal')).show();
                    };
                    document.getElementById('editAttendsToForm').onsubmit = async function(e) {
                        e.preventDefault();
                        const nurseid = document.getElementById('editAttendsToNurseID').value;
                        const pid = document.getElementById('editAttendsToPID').value;
                        const StartDate = document.getElementById('editAttendsToStartDate').value;
                        const EndDate = document.getElementById('editAttendsToEndDate').value || null;
                        await fetch(`/api/attendsto/${nurseid}/${pid}`, {
                            method: 'PUT',
                            headers: { 'Content-Type': 'application/json' },
                            body: JSON.stringify({ StartDate, EndDate })
                        });
                        bootstrap.Modal.getOrCreateInstance(document.getElementById('editAttendsToModal')).hide();
                        loadAttendsTo();
                    };
                    window.deleteAttendsTo = async function(nurseid, pid) {
                        if (!confirm('Delete this AttendsTo record?')) return;
                        await fetch(`/api/attendsto/${nurseid}/${pid}`, { method: 'DELETE' });
                        loadAttendsTo();
                    };
                } catch (err) { tableContent.innerHTML = `<div class='alert alert-danger'>Failed to load AttendsTo records.</div>`; }
            }

            async function loadDiagnosis() {
                tableContent.innerHTML = `<div class='text-center'><div class='spinner-border'></div> Loading Diagnosis records...</div>`;
                try {
                    const response = await fetch('/api/diagnoses');
                    const records = await response.json();
                    let html = `<h4>Diagnosis</h4><table class='table table-bordered'><thead><tr><th>PID</th><th>PhysicianID</th><th>IllnessCode</th><th>Date</th><th>Notes</th><th>Comment</th><th>Actions</th></tr></thead><tbody>`;
                    for (const r of records) {
                        html += `<tr><td>${r.PID}</td><td>${r.PhysicianID}</td><td>${r.IllnessCode}</td><td>${r.Date || ''}</td><td>${r.Notes || ''}</td><td>${r.Comment || ''}</td>
                        <td><button class='btn btn-primary btn-sm' onclick='editDiagnosis(${r.PID},${r.PhysicianID},${r.IllnessCode})'>Edit</button>
                        <button class='btn btn-danger btn-sm' onclick='deleteDiagnosis(${r.PID},${r.PhysicianID},${r.IllnessCode})'>Delete</button></td></tr>`;
                    }
                    html += `</tbody></table>`;
                    html += `<h5>Add Diagnosis</h5><form id='addDiagnosisForm'><div class='mb-2'><input type='number' class='form-control' name='PID' placeholder='PID' required /></div><div class='mb-2'><input type='number' class='form-control' name='PhysicianID' placeholder='PhysicianID' required /></div><div class='mb-2'><input type='number' class='form-control' name='IllnessCode' placeholder='IllnessCode' required /></div><div class='mb-2'><input type='date' class='form-control' name='Date' placeholder='Date' required /></div><div class='mb-2'><input type='text' class='form-control' name='Notes' placeholder='Notes' /></div><div class='mb-2'><input type='text' class='form-control' name='Comment' placeholder='Comment' /></div><button type='submit' class='btn btn-success'>Add Diagnosis</button></form><div id='diagnosisFormMsg' class='mt-2'></div>`;
                    tableContent.innerHTML = html;
                    document.getElementById('addDiagnosisForm').onsubmit = async function(e) {
                        e.preventDefault();
                        const form = e.target;
                        const data = { PID: form.PID.value, PhysicianID: form.PhysicianID.value, IllnessCode: form.IllnessCode.value, Date: form.Date.value, Notes: form.Notes.value, Comment: form.Comment.value };
                        await fetch('/api/diagnoses', { method: 'POST', headers: { 'Content-Type': 'application/json' }, body: JSON.stringify(data) });
                        document.getElementById('diagnosisFormMsg').innerHTML = `<div class='alert alert-info'>Diagnosis added successfully</div>`;
                        loadDiagnosis();
                    };
                    window.editDiagnosis = function(pid, physicianid, illnesscode) {
                        const r = records.find(x => x.PID === pid && x.PhysicianID === physicianid && x.IllnessCode === illnesscode);
                        if (!r) return;
                        document.getElementById('editDiagnosisPID').value = r.PID;
                        document.getElementById('editDiagnosisPhysicianID').value = r.PhysicianID;
                        document.getElementById('editDiagnosisIllnessCode').value = r.IllnessCode;
                        document.getElementById('editDiagnosisDate').value = r.Date ? r.Date.split('T')[0] : '';
                        document.getElementById('editDiagnosisNotes').value = r.Notes || '';
                        document.getElementById('editDiagnosisComment').value = r.Comment || '';
                        document.getElementById('editDiagnosisModalLabel').innerText = `Edit Diagnosis (PID: ${r.PID}, PhysicianID: ${r.PhysicianID}, IllnessCode: ${r.IllnessCode})`;
                        bootstrap.Modal.getOrCreateInstance(document.getElementById('editDiagnosisModal')).show();
                    };
                    document.getElementById('editDiagnosisForm').onsubmit = async function(e) {
                        e.preventDefault();
                        const pid = document.getElementById('editDiagnosisPID').value;
                        const physicianid = document.getElementById('editDiagnosisPhysicianID').value;
                        const illnesscode = document.getElementById('editDiagnosisIllnessCode').value;
                        const Date = document.getElementById('editDiagnosisDate').value;
                        const Notes = document.getElementById('editDiagnosisNotes').value;
                        const Comment = document.getElementById('editDiagnosisComment').value;
                        await fetch(`/api/diagnoses/${pid}/${physicianid}/${illnesscode}`, {
                            method: 'PUT',
                            headers: { 'Content-Type': 'application/json' },
                            body: JSON.stringify({ Date, Notes, Comment })
                        });
                        bootstrap.Modal.getOrCreateInstance(document.getElementById('editDiagnosisModal')).hide();
                        loadDiagnosis();
                    };
                    window.deleteDiagnosis = async function(pid, physicianid, illnesscode) {
                        if (!confirm('Delete this Diagnosis record?')) return;
                        await fetch(`/api/diagnoses/${pid}/${physicianid}/${illnesscode}`, { method: 'DELETE' });
                        loadDiagnosis();
                    };
                } catch (err) { tableContent.innerHTML = `<div class='alert alert-danger'>Failed to load Diagnosis records.</div>`; }
            }

            async function loadPatientAllergy() {
                tableContent.innerHTML = `<div class='text-center'><div class='spinner-border'></div> Loading Patient_Allergy records...</div>`;
                try {
                    const response = await fetch('/api/patientallergies');
                    const records = await response.json();
                    let html = `<h4>Patient_Allergy</h4><table class='table table-bordered'><thead><tr><th>PID</th><th>AllergyCode</th><th>Actions</th></tr></thead><tbody>`;
                    for (const r of records) {
                        html += `<tr><td>${r.PID}</td><td>${r.AllergyCode}</td>
                        <td><button class='btn btn-primary btn-sm' onclick='editPatientAllergy(${r.PID},${r.AllergyCode})'>Edit</button><button class='btn btn-danger btn-sm' onclick='deletePatientAllergy(${r.PID},${r.AllergyCode})'>Delete</button></td></tr>`;
                    }
                    html += `</tbody></table>`;
                    html += `<h5>Add Patient_Allergy</h5><form id='addPatientAllergyForm'><div class='mb-2'><input type='number' class='form-control' name='PID' placeholder='PID' required /></div><div class='mb-2'><input type='number' class='form-control' name='AllergyCode' placeholder='AllergyCode' required /></div><button type='submit' class='btn btn-success'>Add Patient_Allergy</button></form><div id='patientAllergyFormMsg' class='mt-2'></div>`;
                    tableContent.innerHTML = html;
                    window.editPatientAllergy = function(pid, allergycode) {
                        const r = records.find(x => x.PID === pid && x.AllergyCode === allergycode);
                        if (!r) return;
                        document.getElementById('editPatientAllergyPID').value = r.PID;
                        document.getElementById('editPatientAllergyOldAllergyCode').value = r.AllergyCode;
                        document.getElementById('editPatientAllergyAllergyCode').value = r.AllergyCode;
                        document.getElementById('editPatientAllergyModalLabel').innerText = `Edit Patient_Allergy (PID: ${r.PID})`;
                        bootstrap.Modal.getOrCreateInstance(document.getElementById('editPatientAllergyModal')).show();
                    };
                    document.getElementById('editPatientAllergyForm').onsubmit = async function(e) {
                        e.preventDefault();
                        const pid = document.getElementById('editPatientAllergyPID').value;
                        const oldAllergyCode = document.getElementById('editPatientAllergyOldAllergyCode').value;
                        const newAllergyCode = document.getElementById('editPatientAllergyAllergyCode').value;
                        if (newAllergyCode && newAllergyCode != oldAllergyCode) {
                            await fetch(`/api/patientallergies/${pid}/${oldAllergyCode}`, { method: 'DELETE' });
                            await fetch('/api/patientallergies', { method: 'POST', headers: { 'Content-Type': 'application/json' }, body: JSON.stringify({ PID: pid, AllergyCode: newAllergyCode }) });
                        }
                        bootstrap.Modal.getOrCreateInstance(document.getElementById('editPatientAllergyModal')).hide();
                        loadPatientAllergy();
                    };
                    window.deletePatientAllergy = async function(pid, allergycode) {
                        if (!confirm('Delete this Patient_Allergy record?')) return;
                        await fetch(`/api/patientallergies/${pid}/${allergycode}`, { method: 'DELETE' });
                        loadPatientAllergy();
                    };
                } catch (err) { tableContent.innerHTML = `<div class='alert alert-danger'>Failed to load Patient_Allergy records.</div>`; }
            }

            async function loadReactsWith() {
                tableContent.innerHTML = `<div class='text-center'><div class='spinner-border'></div> Loading ReactsWith records...</div>`;
                try {
                    // Fetch medicines for dropdowns
                    const [medicinesResp, reactsResp] = await Promise.all([
                        fetch('/api/medicines'),
                        fetch('/api/reactswith')
                    ]);
                    const medicines = await medicinesResp.json();
                    const records = await reactsResp.json();
                    let html = `<h4>ReactsWith</h4><table class='table table-bordered'><thead><tr><th>Medicine1</th><th>Medicine2</th><th>Severity</th><th>Actions</th></tr></thead><tbody>`;
                    for (const r of records) {
                        const med1 = medicines.find(m => m.code === r.Medicine1);
                        const med2 = medicines.find(m => m.code === r.Medicine2);
                        html += `<tr><td>${med1 ? med1.name : r.Medicine1}</td><td>${med2 ? med2.name : r.Medicine2}</td><td>${r.Severity}</td>
                        <td><button class='btn btn-primary btn-sm' onclick='editReactsWith(${r.Medicine1},${r.Medicine2})'>Edit</button> <button class='btn btn-danger btn-sm' onclick='deleteReactsWith(${r.Medicine1},${r.Medicine2})'>Delete</button></td></tr>`;
                    }
                    html += `</tbody></table>`;
                    html += `<h5>Add ReactsWith</h5><form id='addReactsWithForm'>`;
                    html += `<div class='mb-2'><select class='form-control' name='Medicine1' required><option value=''>Select Medicine 1</option>`;
                    for (const m of medicines) {
                        html += `<option value='${m.code}'>${m.name} (ID: ${m.code})</option>`;
                    }
                    html += `</select></div>`;
                    html += `<div class='mb-2'><select class='form-control' name='Medicine2' required><option value=''>Select Medicine 2</option>`;
                    for (const m of medicines) {
                        html += `<option value='${m.code}'>${m.name} (ID: ${m.code})</option>`;
                    }
                    html += `</select></div>`;
                    html += `<div class='mb-2'><input type='text' class='form-control' name='Severity' placeholder='Severity (S/M/L/N)' required /></div>`;
                    html += `<button type='submit' class='btn btn-success'>Add ReactsWith</button></form><div id='reactsWithFormMsg' class='mt-2'></div>`;
                    tableContent.innerHTML = html;
                    document.getElementById('addReactsWithForm').onsubmit = async function(e) {
                        e.preventDefault();
                        const form = e.target;
                        const data = { Medicine1: form.Medicine1.value, Medicine2: form.Medicine2.value, Severity: form.Severity.value };
                        await fetch('/api/reactswith', { method: 'POST', headers: { 'Content-Type': 'application/json' }, body: JSON.stringify(data) });
                        document.getElementById('reactsWithFormMsg').innerHTML = `<div class='alert alert-info'>ReactsWith added successfully</div>`;
                        loadReactsWith();
                    };
                    window.deleteReactsWith = async function(m1, m2) {
                        if (!confirm('Delete this ReactsWith record?')) return;
                        await fetch(`/api/reactswith/${m1}/${m2}`, { method: 'DELETE' });
                        loadReactsWith();
                    };
                } catch (err) { tableContent.innerHTML = `<div class='alert alert-danger'>Failed to load ReactsWith records.</div>`; }
            }

            async function loadPrescriptions() {
                tableContent.innerHTML = `<div class='text-center'><div class='spinner-border'></div> Loading Prescriptions...</div>`;
                try {
                    const response = await fetch('/api/prescriptions');
                    const records = await response.json();
                    let html = `<h4>Prescription</h4><table class='table table-bordered'><thead><tr><th>PrescriptionID</th><th>PID</th><th>MedicineCode</th><th>Prescriber</th><th>DatePrescrbed</th><th>DateFilled</th><th>Dosage</th><th>Duration</th><th>Frequency</th><th>Quantity</th><th>Actions</th></tr></thead><tbody>`;
                    for (const r of records) {
                        html += `<tr><td>${r.prescriptionid}</td><td>${r.pid}</td><td>${r.medicinecode}</td><td>${r.prescriber}</td><td>${r.dateprescrbed || ''}</td><td>${r.datefilled || ''}</td><td>${r.dosage || ''}</td><td>${r.duration || ''}</td><td>${r.frequency || ''}</td><td>${r.quantity || ''}</td>
                        <td><button class='btn btn-primary btn-sm' onclick='editPrescription(${r.prescriptionid})'>Edit</button>
                        <button class='btn btn-danger btn-sm' onclick='deletePrescription(${r.prescriptionid})'>Delete</button></td></tr>`;
                    }
                    html += `</tbody></table>`;
                    html += `<h5>Add Prescription</h5><form id='addPrescriptionForm'>
                        <div class='mb-2'><input type='number' class='form-control' name='PrescriptionID' placeholder='PrescriptionID' required /></div>
                        <div class='mb-2'><input type='number' class='form-control' name='PID' placeholder='PID' required /></div>
                        <div class='mb-2'><input type='number' class='form-control' name='MedicineCode' placeholder='MedicineCode' required /></div>
                        <div class='mb-2'><input type='number' class='form-control' name='Prescriber' placeholder='Prescriber' required /></div>
                        <div class='mb-2'><input type='date' class='form-control' name='DatePrescrbed' placeholder='DatePrescrbed' required /></div>
                        <div class='mb-2'><input type='date' class='form-control' name='DateFilled' placeholder='DateFilled' /></div>
                        <div class='mb-2'><input type='text' class='form-control' name='Dosage' placeholder='Dosage' required /></div>
                        <div class='mb-2'><input type='text' class='form-control' name='Duration' placeholder='Duration' required /></div>
                        <div class='mb-2'><input type='text' class='form-control' name='Frequency' placeholder='Frequency' required /></div>
                        <div class='mb-2'><input type='number' class='form-control' name='Quantity' placeholder='Quantity' required /></div>
                        <button type='submit' class='btn btn-success'>Add Prescription</button></form><div id='prescriptionFormMsg' class='mt-2'></div>`;
                    tableContent.innerHTML = html;
                    document.getElementById('addPrescriptionForm').onsubmit = async function(e) {
                        e.preventDefault();
                        const form = e.target;
                        const data = {
                            prescriptionid: form.PrescriptionID.value,
                            pid: form.PID.value,
                            medicinecode: form.MedicineCode.value,
                            prescriber: form.Prescriber.value,
                            dateprescrbed: form.DatePrescrbed.value,
                            datefilled: form.DateFilled.value || null,
                            dosage: form.Dosage.value,
                            duration: form.Duration.value,
                            frequency: form.Frequency.value,
                            quantity: form.Quantity.value
                        };
                        await fetch('/api/prescriptions', { method: 'POST', headers: { 'Content-Type': 'application/json' }, body: JSON.stringify(data) });
                        document.getElementById('prescriptionFormMsg').innerHTML = `<div class='alert alert-info'>Prescription added successfully</div>`;
                        loadPrescriptions();
                    };
                    window.editPrescription = function(prescriptionid) {
                        const r = records.find(x => x.prescriptionid === prescriptionid);
                        if (!r) return;
                        document.getElementById('editPrescriptionID').value = r.prescriptionid;
                        document.getElementById('editPrescriptionPID').value = r.pid;
                        document.getElementById('editPrescriptionMedicineCode').value = r.medicinecode;
                        document.getElementById('editPrescriptionPrescriber').value = r.prescriber;
                        document.getElementById('editPrescriptionDatePrescrbed').value = r.dateprescrbed ? r.dateprescrbed.split('T')[0] : '';
                        document.getElementById('editPrescriptionDateFilled').value = r.datefilled ? r.datefilled.split('T')[0] : '';
                        document.getElementById('editPrescriptionDosage').value = r.dosage || '';
                        document.getElementById('editPrescriptionDuration').value = r.duration || '';
                        document.getElementById('editPrescriptionFrequency').value = r.frequency || '';
                        document.getElementById('editPrescriptionQuantity').value = r.quantity || '';
                        document.getElementById('editPrescriptionModalLabel').innerText = `Edit Prescription #${r.prescriptionid}`;
                        bootstrap.Modal.getOrCreateInstance(document.getElementById('editPrescriptionModal')).show();
                    };
                    document.getElementById('editPrescriptionForm').onsubmit = async function(e) {
                        e.preventDefault();
                        const prescriptionid = document.getElementById('editPrescriptionID').value;
                        const pid = document.getElementById('editPrescriptionPID').value;
                        const medicinecode = document.getElementById('editPrescriptionMedicineCode').value;
                        const prescriber = document.getElementById('editPrescriptionPrescriber').value;
                        const dateprescrbed = document.getElementById('editPrescriptionDatePrescrbed').value;
                        const datefilled = document.getElementById('editPrescriptionDateFilled').value || null;
                        const dosage = document.getElementById('editPrescriptionDosage').value;
                        const duration = document.getElementById('editPrescriptionDuration').value;
                        const frequency = document.getElementById('editPrescriptionFrequency').value;
                        const quantity = document.getElementById('editPrescriptionQuantity').value;
                        await fetch(`/api/prescriptions/${prescriptionid}`, {
                            method: 'PUT',
                            headers: { 'Content-Type': 'application/json' },
                            body: JSON.stringify({ pid, medicinecode, prescriber, dateprescrbed, datefilled, dosage, duration, frequency, quantity })
                        });
                        bootstrap.Modal.getOrCreateInstance(document.getElementById('editPrescriptionModal')).hide();
                        loadPrescriptions();
                    };
                    window.deletePrescription = async function(prescriptionid) {
                        if (!confirm('Delete this Prescription record?')) return;
                        await fetch(`/api/prescriptions/${prescriptionid}`, { method: 'DELETE' });
                        loadPrescriptions();
                    };
                } catch (err) { tableContent.innerHTML = `<div class='alert alert-danger'>Failed to load Prescription records.</div>`; }
            }

            async function loadSurgeryTypes() {
                tableContent.innerHTML = `<div class='text-center'><div class='spinner-border'></div> Loading Surgery Types...</div>`;
                try {
                    const response = await fetch('/api/surgerytypes');
                    const records = await response.json();
                    let html = `<h4>Surgery_Type</h4><table class='table table-bordered'><thead><tr><th>SurgeryCode</th><th>Name</th><th>Type</th><th>AnatomicLocation</th><th>SpecialNeeds</th><th>Actions</th></tr></thead><tbody>`;
                    for (const r of records) {
                        html += `<tr><td>${r.SurgeryCode}</td><td>${r.Name}</td><td>${r.Type}</td><td>${r.AnatomicLocation}</td><td>${r.SpecialNeeds || ''}</td>
                        <td><button class='btn btn-primary btn-sm' onclick='editSurgeryType(${r.SurgeryCode})'>Edit</button><button class='btn btn-danger btn-sm' onclick='deleteSurgeryType(${r.SurgeryCode})'>Delete</button></td></tr>`;
                    }
                    html += `</tbody></table>`;
                    html += `<h5>Add Surgery_Type</h5><form id='addSurgeryTypeForm'><div class='mb-2'><input type='number' class='form-control' name='SurgeryCode' placeholder='SurgeryCode' required /></div><div class='mb-2'><input type='text' class='form-control' name='Name' placeholder='Name' required /></div><div class='mb-2'><input type='text' class='form-control' name='Type' placeholder='Type (H/O)' required /></div><div class='mb-2'><input type='text' class='form-control' name='AnatomicLocation' placeholder='AnatomicLocation' required /></div><div class='mb-2'><input type='text' class='form-control' name='SpecialNeeds' placeholder='SpecialNeeds' /></div><button type='submit' class='btn btn-success'>Add Surgery_Type</button></form><div id='surgeryTypeFormMsg' class='mt-2'></div>`;
                    tableContent.innerHTML = html;
                    window.editSurgeryType = function(surgerycode) {
                        const r = records.find(x => x.SurgeryCode === surgerycode);
                        if (!r) return;
                        document.getElementById('editSurgeryTypeCode').value = r.SurgeryCode;
                        document.getElementById('editSurgeryTypeName').value = r.Name;
                        document.getElementById('editSurgeryTypeType').value = r.Type;
                        document.getElementById('editSurgeryTypeAnatomicLocation').value = r.AnatomicLocation;
                        document.getElementById('editSurgeryTypeSpecialNeeds').value = r.SpecialNeeds || '';
                        document.getElementById('editSurgeryTypeModalLabel').innerText = `Edit Surgery_Type #${r.SurgeryCode}`;
                        bootstrap.Modal.getOrCreateInstance(document.getElementById('editSurgeryTypeModal')).show();
                    };
                    document.getElementById('editSurgeryTypeForm').onsubmit = async function(e) {
                        e.preventDefault();
                        const surgerycode = document.getElementById('editSurgeryTypeCode').value;
                        const Name = document.getElementById('editSurgeryTypeName').value;
                        const Type = document.getElementById('editSurgeryTypeType').value;
                        const AnatomicLocation = document.getElementById('editSurgeryTypeAnatomicLocation').value;
                        const SpecialNeeds = document.getElementById('editSurgeryTypeSpecialNeeds').value;
                        await fetch(`/api/surgerytypes/${surgerycode}`, { method: 'PUT', headers: { 'Content-Type': 'application/json' }, body: JSON.stringify({ Name, Type, AnatomicLocation, SpecialNeeds }) });
                        bootstrap.Modal.getOrCreateInstance(document.getElementById('editSurgeryTypeModal')).hide();
                        loadSurgeryTypes();
                    };
                    window.deleteSurgeryType = async function(surgerycode) {
                        if (!confirm('Delete this Surgery_Type record?')) return;
                        await fetch(`/api/surgerytypes/${surgerycode}`, { method: 'DELETE' });
                        loadSurgeryTypes();
                    };
                } catch (err) { tableContent.innerHTML = `<div class='alert alert-danger'>Failed to load Surgery_Type records.</div>`; }
            }

            async function loadSurgerySkills() {
                tableContent.innerHTML = `<div class='text-center'><div class='spinner-border'></div> Loading Surgery Skills...</div>`;
                try {
                    const response = await fetch('/api/surgeryskills');
                    const records = await response.json();
                    let html = `<h4>Surgery_Skill</h4><table class='table table-bordered'><thead><tr><th>SkillCode</th><th>Description</th><th>Actions</th></tr></thead><tbody>`;
                    for (const r of records) {
                        html += `<tr><td>${r.SkillCode}</td><td>${r.Description}</td>
                        <td><button class='btn btn-primary btn-sm' onclick='editSurgerySkill(${r.SkillCode})'>Edit</button><button class='btn btn-danger btn-sm' onclick='deleteSurgerySkill(${r.SkillCode})'>Delete</button></td></tr>`;
                    }
                    html += `</tbody></table>`;
                    html += `<h5>Add Surgery_Skill</h5><form id='addSurgerySkillForm'><div class='mb-2'><input type='number' class='form-control' name='SkillCode' placeholder='SkillCode' required /></div><div class='mb-2'><input type='text' class='form-control' name='Description' placeholder='Description' required /></div><button type='submit' class='btn btn-success'>Add Surgery_Skill</button></form><div id='surgerySkillFormMsg' class='mt-2'></div>`;
                    tableContent.innerHTML = html;
                    // Add handler for addSurgerySkillForm
                    if (document.getElementById('addSurgerySkillForm')) {
                        document.getElementById('addSurgerySkillForm').onsubmit = async function(e) {
                            e.preventDefault();
                            const form = e.target;
                            const data = {
                                SkillCode: form.SkillCode.value,
                                Description: form.Description.value
                            };
                            const resp = await fetch('/api/surgeryskills', {
                                method: 'POST',
                                headers: { 'Content-Type': 'application/json' },
                                body: JSON.stringify(data)
                            });
                            const result = await resp.json();
                            document.getElementById('surgerySkillFormMsg').innerHTML = `<div class='alert alert-info'>${result.error ? 'Error: ' + result.error : 'Surgery_Skill added successfully'}</div>`;
                            loadSurgerySkills();
                        };
                    }
                } catch (err) { tableContent.innerHTML = `<div class='alert alert-danger'>Failed to load Surgery_Skill records.</div>`; }
            }

            async function loadSurgeryTypeSkills() {
                tableContent.innerHTML = `<div class='text-center'><div class='spinner-border'></div> Loading Surgery_Type_Skill records...</div>`;
                try {
                    const response = await fetch('/api/surgerytypeskills');
                    const records = await response.json();
                    let html = `<h4>Surgery_Type_Skill</h4><table class='table table-bordered'><thead><tr><th>SurgeryCode</th><th>SkillCode</th><th>Actions</th></tr></thead><tbody>`;
                    for (const r of records) {
                        html += `<tr><td>${r.SurgeryCode}</td><td>${r.SkillCode}</td>
                        <td><button class='btn btn-primary btn-sm' onclick='editSurgeryTypeSkill(${r.SurgeryCode},${r.SkillCode})'>Edit</button><button class='btn btn-danger btn-sm' onclick='deleteSurgeryTypeSkill(${r.SurgeryCode},${r.SkillCode})'>Delete</button></td></tr>`;
                    }
                    html += `</tbody></table>`;
                    html += `<h5>Add Surgery_Type_Skill</h5><form id='addSurgeryTypeSkillForm'><div class='mb-2'><input type='number' class='form-control' name='SurgeryCode' placeholder='SurgeryCode' required /></div><div class='mb-2'><input type='number' class='form-control' name='SkillCode' placeholder='SkillCode' required /></div><button type='submit' class='btn btn-success'>Add Surgery_Type_Skill</button></form><div id='surgeryTypeSkillFormMsg' class='mt-2'></div>`;
                    tableContent.innerHTML = html;
                    window.editSurgeryTypeSkill = function(surgerycode, skillcode) {
                        const r = records.find(x => x.SurgeryCode === surgerycode && x.SkillCode === skillcode);
                        if (!r) return;
                        document.getElementById('editSurgeryTypeSkillOldSurgeryCode').value = r.SurgeryCode;
                        document.getElementById('editSurgeryTypeSkillOldSkillCode').value = r.SkillCode;
                        document.getElementById('editSurgeryTypeSkillSurgeryCode').value = r.SurgeryCode;
                        document.getElementById('editSurgeryTypeSkillSkillCode').value = r.SkillCode;
                        document.getElementById('editSurgeryTypeSkillModalLabel').innerText = `Edit Surgery_Type_Skill (SurgeryCode: ${r.SurgeryCode}, SkillCode: ${r.SkillCode})`;
                        bootstrap.Modal.getOrCreateInstance(document.getElementById('editSurgeryTypeSkillModal')).show();
                    };
                    document.getElementById('editSurgeryTypeSkillForm').onsubmit = async function(e) {
                        e.preventDefault();
                        const oldSurgeryCode = document.getElementById('editSurgeryTypeSkillOldSurgeryCode').value;
                        const oldSkillCode = document.getElementById('editSurgeryTypeSkillOldSkillCode').value;
                        const newSurgeryCode = document.getElementById('editSurgeryTypeSkillSurgeryCode').value;
                        const newSkillCode = document.getElementById('editSurgeryTypeSkillSkillCode').value;
                        if ((newSurgeryCode != oldSurgeryCode || newSkillCode != oldSkillCode) && newSurgeryCode && newSkillCode) {
                            await fetch(`/api/surgerytypeskills/${oldSurgeryCode}/${oldSkillCode}`, { method: 'DELETE' });
                            await fetch('/api/surgerytypeskills', { method: 'POST', headers: { 'Content-Type': 'application/json' }, body: JSON.stringify({ SurgeryCode: newSurgeryCode, SkillCode: newSkillCode }) }).then(() => loadSurgeryTypeSkills());
                        }
                        bootstrap.Modal.getOrCreateInstance(document.getElementById('editSurgeryTypeSkillModal')).hide();
                        loadSurgeryTypeSkills();
                    };
                    window.deleteSurgeryTypeSkill = async function(surgerycode, skillcode) {
                        if (!confirm('Delete this Surgery_Type_Skill record?')) return;
                        await fetch(`/api/surgerytypeskills/${surgerycode}/${skillcode}`, { method: 'DELETE' });
                        loadSurgeryTypeSkills();
                    };
                } catch (err) { tableContent.innerHTML = `<div class='alert alert-danger'>Failed to load Surgery_Type_Skill records.</div>`; }
            }

            async function loadNurseSkills() {
                tableContent.innerHTML = `<div class='text-center'><div class='spinner-border'></div> Loading Nurse_Skill records...</div>`;
                try {
                    const response = await fetch('/api/nurseskills');
                    const records = await response.json();
                    let html = `<h4>Nurse_Skill</h4><table class='table table-bordered'><thead><tr><th>NurseID</th><th>SkillCode</th><th>Actions</th></tr></thead><tbody>`;
                    for (const r of records) {
                        html += `<tr><td>${r.NurseID}</td><td>${r.SkillCode}</td>
                        <td><button class='btn btn-primary btn-sm' onclick='editNurseSkill(${r.NurseID},${r.SkillCode})'>Edit</button><button class='btn btn-danger btn-sm' onclick='deleteNurseSkill(${r.NurseID},${r.SkillCode})'>Delete</button></td></tr>`;
                    }
                    html += `</tbody></table>`;
                    // Fetch nurses without skill and all skills for dropdowns
                    const [nurseResp, skillResp] = await Promise.all([
                        fetch('/api/nurses_without_skill'),
                        fetch('/api/surgeryskills')
                    ]);
                    const nurses = await nurseResp.json();
                    const skills = await skillResp.json();
                    html += `<h5>Add Nurse_Skill</h5><form id='addNurseSkillForm'>`;
                    html += `<div class='mb-2'><select class='form-control' name='NurseID' required><option value=''>Select Nurse</option>`;
                    for (const n of nurses) {
                        html += `<option value='${n.nurseid}'>${n.nurseid} - ${n.first_name} ${n.last_name} (Grade: ${n.grade}, Years: ${n.years})</option>`;
                    }
                    html += `</select></div>`;
                    html += `<div class='mb-2'><select class='form-control' name='SkillCode' required><option value=''>Select Skill</option>`;
                    for (const s of skills) {
                        html += `<option value='${s.SkillCode}'>${s.SkillCode} - ${s.Description}</option>`;
                    }
                    html += `</select></div>`;
                    html += `<button type='submit' class='btn btn-success'>Add Nurse_Skill</button></form><div id='nurseSkillFormMsg' class='mt-2'></div>`;
                    tableContent.innerHTML = html;
                    // Add handler for addNurseSkillForm
                    if (document.getElementById('addNurseSkillForm')) {
                        document.getElementById('addNurseSkillForm').onsubmit = async function(e) {
                            e.preventDefault();
                            const form = e.target;
                            const data = {
                                NurseID: form.NurseID.value,
                                SkillCode: form.SkillCode.value
                            };
                            const resp = await fetch('/api/nurseskills', {
                                method: 'POST',
                                headers: { 'Content-Type': 'application/json' },
                                body: JSON.stringify(data)
                            });
                            const result = await resp.json();
                            document.getElementById('nurseSkillFormMsg').innerHTML = `<div class='alert alert-info'>${result.error ? 'Error: ' + result.error : 'Nurse_Skill added successfully'}</div>`;
                            loadNurseSkills();
                        };
                    }
                } catch (err) { tableContent.innerHTML = `<div class='alert alert-danger'>Failed to load Nurse_Skill records.</div>`; }
            }

            async function loadNurseSurgeryTypes() {
                tableContent.innerHTML = `<div class='text-center'><div class='spinner-border'></div> Loading Nurse_Surgery_Type records...</div>`;
                try {
                    const response = await fetch('/api/nursesurgerytypes');
                    const records = await response.json();
                    let html = `<h4>Nurse_Surgery_Type</h4><table class='table table-bordered'><thead><tr><th>NurseID</th><th>SurgeryCode</th><th>Actions</th></tr></thead><tbody>`;
                    for (const r of records) {
                        html += `<tr><td>${r.NurseID}</td><td>${r.SurgeryCode}</td>
                        <td><button class='btn btn-primary btn-sm' onclick='editNurseSurgeryType(${r.NurseID},${r.SurgeryCode})'>Edit</button><button class='btn btn-danger btn-sm' onclick='deleteNurseSurgeryType(${r.NurseID},${r.SurgeryCode})'>Delete</button></td></tr>`;
                    }
                    html += `</tbody></table>`;
                    html += `<h5>Add Nurse_Surgery_Type</h5><form id='addNurseSurgeryTypeForm'><div class='mb-2'><input type='number' class='form-control' name='NurseID' placeholder='NurseID' required /></div><div class='mb-2'><input type='number' class='form-control' name='SurgeryCode' placeholder='SurgeryCode' required /></div><button type='submit' class='btn btn-success'>Add Nurse_Surgery_Type</button></form><div id='nurseSurgeryTypeFormMsg' class='mt-2'></div>`;
                    tableContent.innerHTML = html;
                    // Attach handler immediately after rendering the form
                    if (document.getElementById('addNurseSurgeryTypeForm')) {
                        document.getElementById('addNurseSurgeryTypeForm').onsubmit = async function(e) {
                            e.preventDefault();
                            const form = e.target;
                            const data = {
                                NurseID: form.NurseID.value,
                                SurgeryCode: form.SurgeryCode.value
                            };
                            const resp = await fetch('/api/nursesurgerytypes', {
                                method: 'POST',
                                headers: { 'Content-Type': 'application/json' },
                                body: JSON.stringify(data)
                            });
                            const result = await resp.json();
                            document.getElementById('nurseSurgeryTypeFormMsg').innerHTML = `<div class='alert alert-info'>${result.error ? 'Error: ' + result.error : 'Nurse_Surgery_Type added successfully'}</div>`;
                            loadNurseSurgeryTypes();
                        };
                    }
                } catch (err) { tableContent.innerHTML = `<div class='alert alert-danger'>Failed to load Nurse_Surgery_Type records.</div>`; }
            }

            async function loadSurgerySchedules() {
                tableContent.innerHTML = `<div class='text-center'><div class='spinner-border'></div> Loading Surgery_Schedule records...</div>`;
                try {
                    const response = await fetch('/api/surgeryschedules');
                    const records = await response.json();
                    let html = `<h4>Surgery_Schedule</h4><table class='table table-bordered'><thead><tr><th>NurseID</th><th>SurgeryShift</th><th>Date</th><th>Actions</th></tr></thead><tbody>`;
                    for (const r of records) {
                        html += `<tr><td>${r.NurseID}</td><td>${r.SurgeryShift}</td><td>${r.Date || ''}</td>
                        <td><button class='btn btn-primary btn-sm' onclick='editSurgerySchedule(${r.NurseID},"${r.SurgeryShift}","${r.Date}")'>Edit</button><button class='btn btn-danger btn-sm' onclick='deleteSurgerySchedule(${r.NurseID},"${r.SurgeryShift}","${r.Date}")'>Delete</button></td></tr>`;
                    }
                    html += `</tbody></table>`;
                    html += `<h5>Add Surgery_Schedule</h5><form id='addSurgeryScheduleForm'><div class='mb-2'><input type='number' class='form-control' name='NurseID' placeholder='NurseID' required /></div><div class='mb-2'><input type='text' class='form-control' name='SurgeryShift' placeholder='SurgeryShift' required /></div><div class='mb-2'><input type='date' class='form-control' name='Date' placeholder='Date' required /></div><button type='submit' class='btn btn-success'>Add Surgery_Schedule</button></form><div id='surgeryScheduleFormMsg' class='mt-2'></div>`;
                    tableContent.innerHTML = html;
                    // Attach handler immediately after rendering the form
                    if (document.getElementById('addSurgeryScheduleForm')) {
                        document.getElementById('addSurgeryScheduleForm').onsubmit = async function(e) {
                            e.preventDefault();
                            const form = e.target;
                            const data = {
                                NurseID: form.NurseID.value,
                                SurgeryShift: form.SurgeryShift.value,
                                Date: form.Date.value
                            };
                            const resp = await fetch('/api/surgeryschedules', {
                                method: 'POST',
                                headers: { 'Content-Type': 'application/json' },
                                body: JSON.stringify(data)
                            });
                            const result = await resp.json();
                            document.getElementById('surgeryScheduleFormMsg').innerHTML = `<div class='alert alert-info'>${result.error ? 'Error: ' + result.error : 'Surgery_Schedule added successfully'}</div>`;
                            loadSurgerySchedules();
                        };
                    }
                } catch (err) { tableContent.innerHTML = `<div class='alert alert-danger'>Failed to load Surgery_Schedule records.</div>`; }
            }

            async function loadSurgeries() {
                tableContent.innerHTML = `<div class='text-center'><div class='spinner-border'></div> Loading Surgery records...</div>`;
                try {
                    const response = await fetch('/api/surgeries');
                    const records = await response.json();
                    let html = `<h4>Surgery</h4><table class='table table-bordered'><thead><tr><th>PID</th><th>SurgeonID</th><th>SurgeryCode</th><th>Date</th><th>Theater</th><th>SurgeryShift</th><th>Actions</th></tr></thead><tbody>`;
                    for (const r of records) {
                        html += `<tr><td>${r.PID}</td><td>${r.SurgeonID}</td><td>${r.SurgeryCode}</td><td>${r.Date || ''}</td><td>${r.Theater || ''}</td><td>${r.SurgeryShift || ''}</td>
                        <td><button class='btn btn-primary btn-sm' onclick='editSurgery(${r.PID},${r.SurgeonID},${r.SurgeryCode},"${r.Date}")'>Edit</button> <button class='btn btn-danger btn-sm' onclick='deleteSurgery(${r.PID},${r.SurgeonID},${r.SurgeryCode},"${r.Date}")'>Delete</button></td></tr>`;
                    }
                    html += `</tbody></table>`;
                    html += `<h5>Add Surgery</h5><form id='addSurgeryForm'><div class='mb-2'><input type='number' class='form-control' name='PID' placeholder='PID' required /></div><div class='mb-2'><input type='number' class='form-control' name='SurgeonID' placeholder='SurgeonID' required /></div><div class='mb-2'><input type='number' class='form-control' name='SurgeryCode' placeholder='SurgeryCode' required /></div><div class='mb-2'><input type='date' class='form-control' name='Date' placeholder='Date' required /></div><div class='mb-2'><input type='text' class='form-control' name='Theater' placeholder='Theater' required /></div><div class='mb-2'><input type='text' class='form-control' name='SurgeryShift' placeholder='SurgeryShift' /></div><div class='mb-2'><input type='text' class='form-control' name='Nurses' placeholder='Nurse IDs (comma separated, at least 2)' required /></div><button type='submit' class='btn btn-success'>Add Surgery</button></form><div id='surgeryFormMsg' class='mt-2'></div>`;
                    tableContent.innerHTML = html;
                    document.getElementById('addSurgeryForm').onsubmit = async function(e) {
                        e.preventDefault();
                        const form = e.target;
                        const data = {
                            PID: form.PID.value,
                            SurgeonID: form.SurgeonID.value,
                            SurgeryCode: form.SurgeryCode.value,
                            Date: form.Date.value,
                            Theater: form.Theater.value,
                            SurgeryShift: form.SurgeryShift.value || null,
                            Nurses: form.Nurses.value.split(',').map(x => x.trim()).filter(x => x)
                        };
                        const resp = await fetch('/api/surgeries', { method: 'POST', headers: { 'Content-Type': 'application/json' }, body: JSON.stringify(data) });
                        const result = await resp.json();
                        if (result.error) {
                            document.getElementById('surgeryFormMsg').innerHTML = `<div class='alert alert-danger'>${result.error}</div>`;
                        } else {
                            document.getElementById('surgeryFormMsg').innerHTML = `<div class='alert alert-info'>Surgery added successfully</div>`;
                        }
                        loadSurgeries();
                    };
                    window.deleteSurgery = async function(pid, surgeonid, surgerycode, date) {
                        if (!confirm('Delete this Surgery record?')) return;
                        await fetch(`/api/surgeries/${pid}/${surgeonid}/${surgerycode}/${date}`, { method: 'DELETE' });
                        loadSurgeries();
                    };
                } catch (err) { tableContent.innerHTML = `<div class='alert alert-danger'>Failed to load Surgery records.</div>`; }
            }

            function loadTable(table) {
                if (table === 'corporations') {
                    loadCorporations();
                } else if (table === 'clinics') {
                    loadClinics();
                } else if (table === 'employees') {
                    loadEmployees();
                } else if (table === 'physicians') {
                    loadPhysicians();
                } else if (table === 'nurses') {
                    loadNurses();
                } else if (table === 'surgeons') {
                    loadSurgeons();
                } else if (table === 'shifts') {
                    loadShifts();
                } else if (table === 'patients') {
                    loadPatients();
                } else if (table === 'medicaldata') {
                    loadMedicalData();
                } else if (table === 'allergies') {
                    loadAllergies();
                } else if (table === 'illnesses') {
                    loadIllnesses();
                } else if (table === 'clinicbeds') {
                    loadClinicBeds();
                } else if (table === 'admittedto') {
                    loadAdmittedTo();
                } else if (table === 'attendsto') {
                    loadAttendsTo();
                } else if (table === 'diagnoses') {
                    loadDiagnosis();
                } else if (table === 'patientallergies') {
                    loadPatientAllergy();
                } else if (table === 'reactswith') {
                    loadReactsWith();
                } else if (table === 'prescriptions') {
                    loadPrescriptions();
                } else if (table === 'surgerytypes') {
                    loadSurgeryTypes();
                } else if (table === 'surgeryskills') {
                    loadSurgerySkills();
                } else if (table === 'surgerytypeskills') {
                    loadSurgeryTypeSkills();
                } else if (table === 'nurseskills') {
                    loadNurseSkills();
                } else if (table === 'nursesurgerytypes') {
                    loadNurseSurgeryTypes();
                } else if (table === 'surgeryschedules') {
                    loadSurgerySchedules();
                } else if (table === 'surgeries') {
                    loadSurgeries();
                } else {
                    tableContent.innerHTML = `<div class='text-center'><div class='spinner-border'></div> Loading ${table}...</div>`;
                }
            }

            tableSelector.addEventListener('change', function() {
                loadTable(this.value);
            });

            // Load the first table by default
            loadTable(tableSelector.value);

            window.editShift = function(empid, day) {
                const s = shifts.find(shift => shift.empid === empid && shift.day === day);
                if (!s) return;
                document.getElementById('editShiftEmpID').value = s.empid;
                document.getElementById('editShiftDay').value = s.day;
                document.getElementById('editShiftBeginTime').value = s.begin_time;
                document.getElementById('editShiftEndTime').value = s.end_time;
                document.getElementById('editShiftModalLabel').innerText = `Edit Shift: EmpID ${s.empid}, Day ${s.day}`;
                bootstrap.Modal.getOrCreateInstance(document.getElementById('editShiftModal')).show();
            };
            document.getElementById('editShiftForm').onsubmit = async function(e) {
                e.preventDefault();
                const empid = document.getElementById('editShiftEmpID').value;
                const day = document.getElementById('editShiftDay').value;
                const BeginTime = document.getElementById('editShiftBeginTime').value;
                const EndTime = document.getElementById('editShiftEndTime').value;
                await fetch(`/api/shifts/${empid}/${day}`, {
                    method: 'PUT',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ BeginTime, EndTime })
                });
                bootstrap.Modal.getOrCreateInstance(document.getElementById('editShiftModal')).hide();
                loadShifts();
            };

            window.editReactsWith = function(medicine1, medicine2) {
                const r = records.find(x => x.Medicine1 === medicine1 && x.Medicine2 === medicine2);
                if (!r) return;
                // Populate dropdowns
                const med1Select = document.getElementById('editReactsWithMedicine1');
                const med2Select = document.getElementById('editReactsWithMedicine2');
                med1Select.innerHTML = `<option value=''>Select Medicine 1</option>` + medicines.map(m => `<option value='${m.code}'>${m.name} (ID: ${m.code})</option>`).join('');
                med2Select.innerHTML = `<option value=''>Select Medicine 2</option>` + medicines.map(m => `<option value='${m.code}'>${m.name} (ID: ${m.code})</option>`).join('');
                document.getElementById('editReactsWithOldMedicine1').value = r.Medicine1;
                document.getElementById('editReactsWithOldMedicine2').value = r.Medicine2;
                med1Select.value = r.Medicine1;
                med2Select.value = r.Medicine2;
                document.getElementById('editReactsWithSeverity').value = r.Severity;
                document.getElementById('editReactsWithModalLabel').innerText = `Edit ReactsWith (${r.Medicine1}, ${r.Medicine2})`;
                bootstrap.Modal.getOrCreateInstance(document.getElementById('editReactsWithModal')).show();
            };
            document.getElementById('editReactsWithForm').onsubmit = async function(e) {
                e.preventDefault();
                const oldMedicine1 = document.getElementById('editReactsWithOldMedicine1').value;
                const oldMedicine2 = document.getElementById('editReactsWithOldMedicine2').value;
                const newMedicine1 = document.getElementById('editReactsWithMedicine1').value;
                const newMedicine2 = document.getElementById('editReactsWithMedicine2').value;
                const Severity = document.getElementById('editReactsWithSeverity').value;
                if ((newMedicine1 != oldMedicine1 || newMedicine2 != oldMedicine2) && newMedicine1 && newMedicine2) {
                    await fetch(`/api/reactswith/${oldMedicine1}/${oldMedicine2}`, { method: 'DELETE' });
                    await fetch('/api/reactswith', { method: 'POST', headers: { 'Content-Type': 'application/json' }, body: JSON.stringify({ Medicine1: newMedicine1, Medicine2: newMedicine2, Severity }) });
                } else {
                    await fetch(`/api/reactswith/${oldMedicine1}/${oldMedicine2}`, { method: 'DELETE' });
                    await fetch('/api/reactswith', { method: 'POST', headers: { 'Content-Type': 'application/json' }, body: JSON.stringify({ Medicine1: newMedicine1, Medicine2: newMedicine2, Severity }) });
                }
                bootstrap.Modal.getOrCreateInstance(document.getElementById('editReactsWithModal')).hide();
                loadReactsWith();
            };

            window.editSurgery = function(pid, surgeonid, surgerycode, date) {
                const r = records.find(x => x.PID === pid && x.SurgeonID === surgeonid && x.SurgeryCode === surgerycode && x.Date === date);
                if (!r) return;
                document.getElementById('editSurgeryOldPID').value = r.PID;
                document.getElementById('editSurgeryOldSurgeonID').value = r.SurgeonID;
                document.getElementById('editSurgeryOldSurgeryCode').value = r.SurgeryCode;
                document.getElementById('editSurgeryOldDate').value = r.Date;
                document.getElementById('editSurgeryPID').value = r.PID;
                document.getElementById('editSurgerySurgeonID').value = r.SurgeonID;
                document.getElementById('editSurgerySurgeryCode').value = r.SurgeryCode;
                document.getElementById('editSurgeryDate').value = r.Date ? r.Date.split('T')[0] : '';
                document.getElementById('editSurgeryTheater').value = r.Theater || '';
                document.getElementById('editSurgerySurgeryShift').value = r.SurgeryShift || '';
                document.getElementById('editSurgeryModalLabel').innerText = `Edit Surgery (PID: ${r.PID}, SurgeonID: ${r.SurgeonID}, SurgeryCode: ${r.SurgeryCode}, Date: ${r.Date})`;
                bootstrap.Modal.getOrCreateInstance(document.getElementById('editSurgeryModal')).show();
            };
            document.getElementById('editSurgeryForm').onsubmit = async function(e) {
                e.preventDefault();
                const oldPID = document.getElementById('editSurgeryOldPID').value;
                const oldSurgeonID = document.getElementById('editSurgeryOldSurgeonID').value;
                const oldSurgeryCode = document.getElementById('editSurgeryOldSurgeryCode').value;
                const oldDate = document.getElementById('editSurgeryOldDate').value;
                const newPID = document.getElementById('editSurgeryPID').value;
                const newSurgeonID = document.getElementById('editSurgerySurgeonID').value;
                const newSurgeryCode = document.getElementById('editSurgerySurgeryCode').value;
                const newDate = document.getElementById('editSurgeryDate').value;
                const Theater = document.getElementById('editSurgeryTheater').value;
                const SurgeryShift = document.getElementById('editSurgerySurgeryShift').value || null;
                if ((newPID != oldPID || newSurgeonID != oldSurgeonID || newSurgeryCode != oldSurgeryCode || newDate != oldDate) && newPID && newSurgeonID && newSurgeryCode && newDate) {
                    await fetch(`/api/surgeries/${oldPID}/${oldSurgeonID}/${oldSurgeryCode}/${oldDate}`, { method: 'DELETE' });
                    await fetch('/api/surgeries', { method: 'POST', headers: { 'Content-Type': 'application/json' }, body: JSON.stringify({ PID: newPID, SurgeonID: newSurgeonID, SurgeryCode: newSurgeryCode, Date: newDate, Theater, SurgeryShift, Nurses: [] }) });
                }
                bootstrap.Modal.getOrCreateInstance(document.getElementById('editSurgeryModal')).hide();
                loadSurgeries();
            };

            // Surgery_Schedule add form handler
            if (document.getElementById('addSurgeryScheduleForm')) {
                document.getElementById('addSurgeryScheduleForm').onsubmit = async function(e) {
                    e.preventDefault();
                    const form = e.target;
                    const data = {
                        NurseID: form.NurseID.value,
                        SurgeryShift: form.SurgeryShift.value,
                        Date: form.Date.value
                    };
                    const resp = await fetch('/api/surgeryschedules', {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify(data)
                    });
                    const result = await resp.json();
                    document.getElementById('surgeryScheduleFormMsg').innerHTML = `<div class='alert alert-info'>${result.error ? 'Error: ' + result.error : 'Surgery_Schedule added successfully'}</div>`;
                    loadSurgerySchedules();
                };
            }
            // Surgery_Type_Skill add form handler
            if (document.getElementById('addSurgeryTypeSkillForm')) {
                document.getElementById('addSurgeryTypeSkillForm').onsubmit = async function(e) {
                    e.preventDefault();
                    const form = e.target;
                    const data = {
                        SurgeryCode: form.SurgeryCode.value,
                        SkillCode: form.SkillCode.value
                    };
                    const resp = await fetch('/api/surgerytypeskills', {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify(data)
                    });
                    const result = await resp.json();
                    document.getElementById('surgeryTypeSkillFormMsg').innerHTML = `<div class='alert alert-info'>${result.error ? 'Error: ' + result.error : 'Surgery_Type_Skill added successfully'}</div>`;
                    loadSurgeryTypeSkills();
                };
            }
            // Nurse_Skill add form handler
            if (document.getElementById('addNurseSkillForm')) {
                document.getElementById('addNurseSkillForm').onsubmit = async function(e) {
                    e.preventDefault();
                    const form = e.target;
                    const data = {
                        NurseID: form.NurseID.value,
                        SkillCode: form.SkillCode.value
                    };
                    const resp = await fetch('/api/nurseskills', {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify(data)
                    });
                    const result = await resp.json();
                    document.getElementById('nurseSkillFormMsg').innerHTML = `<div class='alert alert-info'>${result.error ? 'Error: ' + result.error : 'Nurse_Skill added successfully'}</div>`;
                    loadNurseSkills();
                };
            }
            // Nurse_Surgery_Type add form handler
            if (document.getElementById('addNurseSurgeryTypeForm')) {
                document.getElementById('addNurseSurgeryTypeForm').onsubmit = async function(e) {
                    e.preventDefault();
                    const form = e.target;
                    const data = {
                        NurseID: form.NurseID.value,
                        SurgeryCode: form.SurgeryCode.value
                    };
                    const resp = await fetch('/api/nursesurgerytypes', {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify(data)
                    });
                    const result = await resp.json();
                    document.getElementById('nurseSurgeryTypeFormMsg').innerHTML = `<div class='alert alert-info'>${result.error ? 'Error: ' + result.error : 'Nurse_Surgery_Type added successfully'}</div>`;
                    loadNurseSurgeryTypes();
                };
            }
            // Surgery add form handler
            if (document.getElementById('addSurgeryForm')) {
                document.getElementById('addSurgeryForm').onsubmit = async function(e) {
                    e.preventDefault();
                    const form = e.target;
                    const data = {
                        PID: form.PID.value,
                        SurgeonID: form.SurgeonID.value,
                        SurgeryCode: form.SurgeryCode.value,
                        Date: form.Date.value,
                        Theater: form.Theater.value,
                        SurgeryShift: form.SurgeryShift.value || null,
                        Nurses: form.Nurses.value.split(',').map(x => x.trim()).filter(x => x)
                    };
                    const resp = await fetch('/api/surgeries', {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify(data)
                    });
                    const result = await resp.json();
                    document.getElementById('surgeryFormMsg').innerHTML = `<div class='alert alert-info'>${result.error ? 'Error: ' + result.error : 'Surgery added successfully'}</div>`;
                    loadSurgeries();
                };
            }
        });
    </script>
</body>
</html> 